<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>VendorSoluce â€” Vendor Risk Radar (Demo)</title>
<link href="data:image/svg+xml;utf8,%3Csvg%20width%3D%2232%22%20height%3D%2232%22%20viewBox%3D%220%200%2064%2064%22%20fill%3D%22none%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20aria-hidden%3D%22true%22%3E%0A%3Cpath%20d%3D%22M32%204l22%2010v18c0%2016-10.2%2027.7-22%2031C20.2%2059.7%2010%2048%2010%2032V14L32%204z%22%20fill%3D%22currentColor%22%20opacity%3D%220.12%22/%3E%0A%3Cpath%20d%3D%22M32%207.5l19%208.7V32c0%2014.5-9.3%2025.1-19%2028.1C22.3%2057.1%2013%2046.5%2013%2032V16.2L32%207.5z%22%20stroke%3D%22currentColor%22%20stroke-width%3D%223%22%20/%3E%0A%3Cpath%20d%3D%22M22%2033c4.5-10.5%2015.5-16%2022-12.5%22%20stroke%3D%22currentColor%22%20stroke-width%3D%223%22%20stroke-linecap%3D%22round%22/%3E%0A%3Cpath%20d%3D%22M20.5%2041c7%204.5%2016.5%203.8%2023.5-2%22%20stroke%3D%22currentColor%22%20stroke-width%3D%223%22%20stroke-linecap%3D%22round%22/%3E%0A%3Ccircle%20cx%3D%2244%22%20cy%3D%2220%22%20r%3D%223.5%22%20fill%3D%22currentColor%22/%3E%0A%3Ccircle%20cx%3D%2218%22%20cy%3D%2242%22%20r%3D%223.5%22%20fill%3D%22currentColor%22/%3E%0A%3C/svg%3E" rel="icon"/>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&amp;display=swap" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
<style>
      :root{
        /* VendorSoluce brand (Growth Green) */
        --vs-green:#33691E;
        --vs-green-dark:#2E5A1A;
        --vs-green-light:#66BB6A;
        --vs-green-pale:#E8F5E8;

        /* Neutrals */
        --bg:#F7F9FC;
        --bg-2:#FFFFFF;
        --card:#FFFFFF;
        --border:rgba(17,24,39,.12);
        --text:#0F172A;
        --muted:rgba(15,23,42,.68);

        /* Risk colors */
        --risk-critical:#DC2626;
        --risk-high:#EA580C;
        --risk-medium:#F59E0B;
        --risk-low:#16A34A;

        /* Shadows */
        --shadow-sm: 0 1px 2px rgba(0,0,0,.06);
        --shadow-md: 0 10px 20px rgba(2,6,23,.08);
        --shadow-lg: 0 20px 45px rgba(2,6,23,.14);
        --ring: 0 0 0 3px rgba(51,105,30,.14);
      }

      html.dark{
        --bg:#070A12;
        --bg-2:rgba(255,255,255,.04);
        --card:rgba(255,255,255,.06);
        --border:rgba(255,255,255,.12);
        --text:rgba(248,250,252,.95);
        --muted:rgba(226,232,240,.70);
        --shadow-sm: 0 1px 2px rgba(0,0,0,.35);
        --shadow-md: 0 12px 24px rgba(0,0,0,.35);
        --shadow-lg: 0 28px 60px rgba(0,0,0,.45);
        --ring: 0 0 0 3px rgba(102,187,106,.18);
      }

      html{color-scheme: light dark;}
      html[data-theme="dark"]{color-scheme: dark;}
      html[data-theme="light"]{color-scheme: light;}

      *{box-sizing:border-box;margin:0;padding:0}
      body{
        font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
        background: radial-gradient(1200px 700px at 20% -10%, rgba(51,105,30,.14), transparent 55%),
                    radial-gradient(900px 600px at 90% 0%, rgba(102,187,106,.12), transparent 50%),
                    var(--bg);
        color: var(--text);
        padding: 24px;
        min-height: 100vh;
        overflow-x:hidden;
      }

      .radar-container{max-width:1800px;margin:0 auto}

      /* Header */
      .radar-header{
        text-align:center;
        padding: 28px 24px;
        background: linear-gradient(180deg, rgba(255,255,255,.92), rgba(255,255,255,.78));
        border: 1px solid var(--border);
        border-radius: 16px;
        margin-bottom: 18px;
        box-shadow: var(--shadow-md);
        position: relative;
        overflow:hidden;
      }
      html.dark .radar-header{
        background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      }
      .radar-header::before{
        content:'';
        position:absolute; inset:0;
        background: radial-gradient(800px 260px at 50% 0%, rgba(51,105,30,.20), transparent 60%);
        pointer-events:none;
      }
      .radar-header h1{
        font-size: 1.85rem;
        font-weight: 800;
        letter-spacing: .2px;
        margin-bottom: 6px;
      }
      .brand-lines{
        display:inline-block;
        line-height:1.05;
        font-weight:800;
      }
      .brand-lines .line1{color:var(--vs-green)}
      .brand-lines .line2{color:var(--text)}
      .brand-lines .line3{color:var(--muted); font-weight:700}
      .radar-status{font-size:.98rem;color:var(--muted);font-weight:600}
      .timestamp{margin-top:8px;font-size:.85rem;color:var(--muted)}

      /* Toolbar */
      .toolbar{
        display:flex; justify-content:space-between; align-items:center;
        padding: 14px 14px;
        background: var(--card);
        border: 1px solid var(--border);
        border-radius: 14px;
        box-shadow: var(--shadow-sm);
        margin-bottom: 16px;
        flex-wrap:wrap;
        gap: 12px;
      }
      .toolbar-group{display:flex; gap:10px; align-items:center; flex-wrap:wrap}

      button{
        background: var(--vs-green);
        color:#fff;
        border: 1px solid rgba(0,0,0,.06);
        padding: 10px 14px;
        border-radius: 12px;
        cursor:pointer;
        font-family: inherit;
        font-size: .9rem;
        font-weight: 700;
        transition: transform .15s ease, box-shadow .15s ease, background .15s ease, opacity .15s ease;
        display:inline-flex;
        align-items:center;
        gap: 8px;
        letter-spacing:.2px;
      }
      button:hover:not(:disabled){
        background: var(--vs-green-dark);
        transform: translateY(-1px);
        box-shadow: 0 8px 18px rgba(51,105,30,.20);
      }
      button:active:not(:disabled){transform: translateY(0px)}
      button:disabled{opacity:.5; cursor:not-allowed}
      button.primary{background: var(--vs-green-dark)}
      button.secondary{
        background: transparent;
        color: var(--vs-green);
        border: 1px solid rgba(51,105,30,.35);
      }
      html.dark button.secondary{color: var(--vs-green-light); border-color: rgba(102,187,106,.40)}
      button.secondary:hover:not(:disabled){
        background: rgba(51,105,30,.10);
        box-shadow:none;
      }
      html.dark button.secondary:hover:not(:disabled){background: rgba(102,187,106,.12)}
      button.danger{
        background: rgba(220,38,38,.12);
        color: var(--risk-critical);
        border: 1px solid rgba(220,38,38,.35);
      }
      button.danger:hover:not(:disabled){
        background: rgba(220,38,38,.18);
        box-shadow: 0 8px 18px rgba(220,38,38,.18);
        transform: translateY(-1px);
      }

      select{
        background: var(--card);
        color: var(--text);
        border: 1px solid var(--border);
        padding: 10px 12px;
        border-radius: 12px;
        font-family: inherit;
        cursor:pointer;
        font-weight: 600;
      }
      select:focus{outline:none; box-shadow: var(--ring); border-color: rgba(51,105,30,.45)}
      input[type="file"]{display:none}

      /* Focus states */
      button:focus-visible, a:focus-visible, select:focus-visible{
        outline:none;
        box-shadow: var(--ring);
      }

      /* Alert Banner */
      .alert-banner{
        padding: 14px 16px;
        border-radius: 14px;
        margin-bottom: 16px;
        display:flex;
        align-items:center;
        gap: 14px;
        border: 1px solid var(--border);
        background: var(--card);
        box-shadow: var(--shadow-sm);
      }
      .alert-banner.critical{border-left: 6px solid var(--risk-critical)}
      .alert-banner.warning{border-left: 6px solid var(--risk-high)}
      .alert-banner.clear{border-left: 6px solid var(--vs-green)}
      .alert-icon{font-size: 1.35rem}
      .alert-title{font-size: 1rem; font-weight: 800; margin-bottom: 2px}
      .alert-content{flex:1}
      .alert-desc{color: var(--muted); font-weight: 600}

      /* Stats Grid */
      .stats-grid{
        display:grid;
        grid-template-columns: repeat(auto-fit, minmax(210px, 1fr));
        gap: 14px;
        margin-bottom: 16px;
      }
      .stat-card{
        background: var(--card);
        border: 1px solid var(--border);
        border-radius: 16px;
        padding: 18px;
        text-align:left;
        box-shadow: var(--shadow-sm);
        position:relative;
        overflow:hidden;
      }
      .stat-card::before{
        content:'';
        position:absolute; inset:0;
        background: radial-gradient(500px 220px at 0% 0%, rgba(51,105,30,.14), transparent 60%);
        pointer-events:none;
      }
      .stat-label{
        font-size: .78rem;
        text-transform: uppercase;
        letter-spacing: .12em;
        color: var(--muted);
        margin-bottom: 8px;
        font-weight: 800;
      }
      .stat-value{
        font-size: 2rem;
        font-weight: 900;
        letter-spacing: -.02em;
      }
      .stat-value.critical{color: var(--risk-critical)}
      .stat-value.warning{color: var(--risk-high)}

      /* Main Grid */
      .radar-grid{
        display:grid;
        grid-template-columns: 1fr 1fr;
        gap: 16px;
        margin-bottom: 16px;
      }
      @media (max-width: 1100px){
        .radar-grid{grid-template-columns:1fr}
      }

      /* Radar Display */
      .radar-display,
      .radar-panel{
        background: var(--card);
        border: 1px solid var(--border);
        border-radius: 16px;
        padding: 20px;
        box-shadow: var(--shadow-md);
      }
      .panel-title{
        font-size: 1.05rem;
        font-weight: 900;
        letter-spacing: .02em;
        margin-bottom: 14px;
        display:flex;
        align-items:center;
        justify-content:space-between;
      }
      .panel-subtitle{font-size:.85rem;color:var(--muted);font-weight:600;margin-top:4px}

      .radar-screen{
        width: 100%;
        max-width: 560px;
        height: 560px;
        margin: 0 auto;
        position: relative;
        background:
          radial-gradient(circle, rgba(51,105,30,.18) 0%, rgba(0,0,0,0) 55%),
          radial-gradient(circle at 50% 50%, rgba(102,187,106,.10) 0%, rgba(0,0,0,0) 70%),
          linear-gradient(180deg, rgba(2,6,23,.04), rgba(2,6,23,.00));
        border-radius: 50%;
        border: 2px solid rgba(51,105,30,.45);
        box-shadow: inset 0 0 60px rgba(51,105,30,.10), 0 18px 40px rgba(2,6,23,.10);
        overflow:hidden;
      }
      html.dark .radar-screen{
        background:
          radial-gradient(circle, rgba(102,187,106,.16) 0%, rgba(0,0,0,0) 60%),
          radial-gradient(circle at 50% 50%, rgba(51,105,30,.10) 0%, rgba(0,0,0,0) 72%),
          linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.00));
        box-shadow: inset 0 0 80px rgba(102,187,106,.10), 0 18px 40px rgba(0,0,0,.28);
      }

      .radar-sweep{
        position:absolute;
        top:50%; left:50%;
        width: 50%;
        height: 2px;
        background: linear-gradient(90deg, rgba(102,187,106,.85), rgba(102,187,106,.0));
        transform-origin: left center;
        animation: sweep 4s linear infinite;
        filter: drop-shadow(0 0 10px rgba(102,187,106,.35));
      }
      @keyframes sweep{0%{transform: rotate(0deg)}100%{transform: rotate(360deg)}}

      .radar-grid-lines{
        position:absolute; top:50%; left:50%;
        width:100%; height:100%;
        transform: translate(-50%, -50%);
      }
      .radar-circle{
        position:absolute;
        border: 1px solid rgba(51,105,30,.20);
        border-radius: 50%;
        top:50%; left:50%;
        transform: translate(-50%, -50%);
      }
      html.dark .radar-circle{border-color: rgba(102,187,106,.18)}
      .radar-circle:nth-child(1){width:25%;height:25%}
      .radar-circle:nth-child(2){width:50%;height:50%}
      .radar-circle:nth-child(3){width:75%;height:75%}
      .radar-circle:nth-child(4){width:100%;height:100%}
      .radar-line{
        position:absolute;
        width: 1px;
        height: 50%;
        background: rgba(51,105,30,.18);
        top:0; left:50%;
        transform-origin: center bottom;
      }
      html.dark .radar-line{background: rgba(102,187,106,.18)}
      .radar-line:nth-child(5){transform: rotate(0deg)}
      .radar-line:nth-child(6){transform: rotate(45deg)}
      .radar-line:nth-child(7){transform: rotate(90deg)}
      .radar-line:nth-child(8){transform: rotate(135deg)}

      .radar-blip{
        position:absolute;
        width: 14px;
        height: 14px;
        border-radius: 999px;
        transform: translate(-50%, -50%);
        cursor:pointer;
        transition: transform .15s ease, box-shadow .15s ease;
        border: 2px solid rgba(255,255,255,.75);
        animation: blip-pulse 2s ease-in-out infinite;
      }
      .radar-blip:hover{transform: translate(-50%, -50%) scale(1.6); z-index: 50}
      .radar-blip.critical{background: var(--risk-critical); box-shadow: 0 0 0 6px rgba(220,38,38,.18)}
      .radar-blip.high{background: var(--risk-high); box-shadow: 0 0 0 6px rgba(234,88,12,.18)}
      .radar-blip.medium{background: var(--risk-medium); box-shadow: 0 0 0 6px rgba(245,158,11,.18)}
      .radar-blip.low{background: var(--vs-green-light); box-shadow: 0 0 0 6px rgba(102,187,106,.18)}
      @keyframes blip-pulse{0%,100%{opacity:1}50%{opacity:.55}}

      .radar-legend{
        display:flex; justify-content:center;
        gap: 14px;
        margin-top: 14px;
        flex-wrap:wrap;
        font-size: .85rem;
        color: var(--muted);
        font-weight: 700;
      }
      .legend-item{display:flex; align-items:center; gap: 8px}
      .legend-dot{width: 10px; height: 10px; border-radius: 999px; border: 1px solid rgba(255,255,255,.75)}

      /* Vendor List */
      .vendor-list{max-height: 520px; overflow:auto; padding-right: 6px}
      .vendor-list::-webkit-scrollbar{width: 10px}
      .vendor-list::-webkit-scrollbar-track{background: rgba(148,163,184,.18); border-radius: 999px}
      .vendor-list::-webkit-scrollbar-thumb{background: rgba(51,105,30,.35); border-radius: 999px}
      html.dark .vendor-list::-webkit-scrollbar-track{background: rgba(255,255,255,.10)}
      html.dark .vendor-list::-webkit-scrollbar-thumb{background: rgba(102,187,106,.28)}

      .vendor-item{
        background: rgba(2,6,23,.02);
        border: 1px solid var(--border);
        border-radius: 14px;
        padding: 14px;
        margin-bottom: 10px;
        cursor:pointer;
        transition: transform .15s ease, border-color .15s ease, box-shadow .15s ease, background .15s ease;
      }
      html.dark .vendor-item{background: rgba(255,255,255,.04)}
      .vendor-item:hover{
        transform: translateY(-1px);
        border-color: rgba(51,105,30,.35);
        box-shadow: 0 10px 22px rgba(2,6,23,.10);
        background: rgba(51,105,30,.05);
      }
      html.dark .vendor-item:hover{border-color: rgba(102,187,106,.35); background: rgba(102,187,106,.08)}

      .vendor-item.critical{border-left: 6px solid var(--risk-critical)}
      .vendor-item.high{border-left: 6px solid var(--risk-high)}
      .vendor-item.medium{border-left: 6px solid var(--risk-medium)}
      .vendor-item.low{border-left: 6px solid var(--vs-green)}

      .vendor-header{display:flex; justify-content:space-between; gap: 10px; align-items:flex-start; margin-bottom: 8px}
      .vendor-name{font-weight: 900; font-size: 1rem}
      .vendor-badges{display:flex; gap: 6px; flex-wrap:wrap; justify-content:flex-end}
      .badge{
        padding: 4px 10px;
        border-radius: 999px;
        font-size: .72rem;
        font-weight: 800;
        letter-spacing: .06em;
        text-transform: uppercase;
        border: 1px solid transparent;
      }
      .badge.critical{background: rgba(220,38,38,.12); color: var(--risk-critical); border-color: rgba(220,38,38,.22)}
      .badge.high{background: rgba(234,88,12,.12); color: var(--risk-high); border-color: rgba(234,88,12,.22)}
      .badge.medium{background: rgba(245,158,11,.12); color: var(--risk-medium); border-color: rgba(245,158,11,.22)}
      .badge.low{background: rgba(51,105,30,.12); color: var(--vs-green); border-color: rgba(51,105,30,.22)}
      .badge.category{background: rgba(148,163,184,.14); color: var(--text); border-color: rgba(148,163,184,.22)}
      html.dark .badge.category{background: rgba(255,255,255,.08); color: var(--text); border-color: rgba(255,255,255,.14)}

      .vendor-details{font-size: .9rem; color: var(--muted); font-weight: 650; line-height:1.35}
      .vendor-metrics{display:grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-top: 10px}
      .metric{
        background: rgba(2,6,23,.02);
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 10px;
      }
      html.dark .metric{background: rgba(255,255,255,.04)}
      .metric-label{font-size:.75rem; color: var(--muted); font-weight: 800; letter-spacing:.08em; text-transform: uppercase}
      .metric-value{font-size: 1.05rem; font-weight: 900; margin-top: 4px}

      /* Modals */
      .modal{
        position:fixed;
        inset:0;
        background: rgba(2,6,23,.55);
        display:none;
        align-items:center;
        justify-content:center;
        padding: 18px;
        z-index: 1000;
      }
      .modal.active{display:flex}
      .modal-content{
        width:min(760px, 100%);
        background: var(--card);
        border: 1px solid var(--border);
        border-radius: 18px;
        box-shadow: var(--shadow-lg);
        padding: 18px;
      }
      .modal-header{display:flex; align-items:flex-start; justify-content:space-between; gap: 12px; margin-bottom: 10px}
      .modal-title{font-size: 1.1rem; font-weight: 900}
      .close-btn{
        background: transparent;
        color: var(--muted);
        border: 1px solid var(--border);
        padding: 8px 10px;
        border-radius: 12px;
      }
      .close-btn:hover{background: rgba(148,163,184,.10); transform:none; box-shadow:none}

      .form-grid{display:grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-top: 10px}
      @media (max-width: 720px){.form-grid{grid-template-columns: 1fr}}
      .form-group label{display:block; font-size:.78rem; font-weight: 800; letter-spacing:.08em; text-transform: uppercase; color: var(--muted); margin-bottom: 6px}
      .form-group input, .form-group textarea, .form-group select{
        width: 100%;
        background: var(--bg-2);
        color: var(--text);
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 10px 12px;
        font-family: inherit;
        font-weight: 650;
      }
      .form-group textarea{min-height: 90px; resize: vertical}
      .form-group input:focus, .form-group textarea:focus, .form-group select:focus{outline:none; box-shadow: var(--ring); border-color: rgba(51,105,30,.45)}

      /* Footer */
      .footer{
        margin-top: 18px;
        text-align:center;
        color: var(--muted);
        font-size: .85rem;
        font-weight: 650;
      }

      /* Print */
      @media print{
        body{background:#fff; color:#000}
        .toolbar, .modal{display:none !important}
        .radar-display, .radar-panel, .stat-card, .radar-header{box-shadow:none}
      }
    

      /* VendorSoluce header/footer + shell */
      .vs-shell{ max-width:1180px; margin:0 auto; padding: 18px 18px 34px; }
      .vs-header{ position:sticky; top:0; z-index:50; border-bottom:1px solid var(--line); background: color-mix(in srgb, var(--panel) 92%, transparent); backdrop-filter: blur(10px); }
      .vs-header__inner{ max-width:1180px; margin:0 auto; padding:14px 18px; display:flex; align-items:center; gap:16px; }
      .vs-brand{ display:flex; gap:12px; align-items:center; text-decoration:none; color:var(--text); }
      .vs-brand__logo{ width:40px; height:40px; display:grid; place-items:center; border-radius:14px; background: linear-gradient(135deg, color-mix(in srgb, var(--brand) 22%, transparent), color-mix(in srgb, var(--brand-2) 14%, transparent)); border:1px solid color-mix(in srgb, var(--brand) 22%, transparent); box-shadow: 0 10px 26px rgba(0,0,0,.18); }
      .vs-brand__text{ display:flex; flex-direction:column; line-height:1.05; }
      .vs-brand__line1{ font-weight:800; letter-spacing:.2px; font-size:14px; }
      .vs-brand__line2{ font-weight:650; font-size:12px; color:var(--muted); }
      .vs-brand__line3{ font-weight:700; font-size:12px; color: color-mix(in srgb, var(--brand) 64%, var(--text)); }

      .vs-nav{ margin-left:10px; display:flex; gap:10px; flex-wrap:wrap; }
      .vs-nav__item{ padding:8px 10px; border-radius:10px; text-decoration:none; color:var(--muted); border:1px solid transparent; }
      .vs-nav__item:hover{ color:var(--text); border-color: var(--line); background: color-mix(in srgb, var(--panel) 75%, transparent); }

      .vs-actions{ margin-left:auto; display:flex; gap:10px; align-items:center; }

      .btn{ display:inline-flex; align-items:center; gap:8px; padding:10px 12px; border-radius:12px; border:1px solid var(--line); background: var(--panel); color:var(--text); cursor:pointer; }
      .btn:hover{ border-color: color-mix(in srgb, var(--brand) 30%, var(--line)); }
      .btn-ghost{ background: transparent; }
      .btn__icon{ font-size:14px; }
      .btn__text{ font-weight:650; font-size:13px; }

      .vs-footer{ border-top:1px solid var(--line); background: color-mix(in srgb, var(--panel) 88%, transparent); }
      .vs-footer__inner{ max-width:1180px; margin:0 auto; padding:16px 18px; display:flex; gap:14px; align-items:center; justify-content:space-between; flex-wrap:wrap; }
      .vs-footer__brand{ display:flex; gap:12px; align-items:center; }
      .vs-footer__logo{ width:40px; height:40px; display:grid; place-items:center; border-radius:14px; border:1px solid var(--line); background: color-mix(in srgb, var(--panel) 70%, transparent); }
      .vs-footer__text{ line-height:1.08; }
      .vs-footer__line1{ font-weight:800; font-size:13px; }
      .vs-footer__line2{ font-weight:650; font-size:12px; color:var(--muted); }
      .vs-footer__line3{ font-weight:700; font-size:12px; color: color-mix(in srgb, var(--brand) 64%, var(--text)); }
      .vs-footer__meta{ display:flex; gap:10px; align-items:center; }
      .pill{ font-size:12px; padding:6px 10px; border-radius:999px; border:1px solid var(--line); background: color-mix(in srgb, var(--panel) 75%, transparent); }
      .muted{ color:var(--muted); font-size:12px; }

      /* Nicer section anchors */
      [id]{ scroll-margin-top: 92px; }

      /* Premium polish additions */
      .vs-watermark{position:fixed; inset:auto 18px 18px auto; z-index:5; font-weight:900; letter-spacing:.22em;
        font-size:12px; padding:10px 12px; border-radius:999px; opacity:.6;
        color: var(--vs-text); background: rgba(2,6,23,.35); border:1px solid rgba(148,163,184,.25); backdrop-filter: blur(10px)}
      [data-theme="light"] .vs-watermark{background: rgba(255,255,255,.65)}
      .vs-hero{margin: 14px 0 18px; padding: 18px; border-radius: 18px;
        background: radial-gradient(1200px 420px at 10% 0%, rgba(51,105,30,.35), transparent 60%),
                    radial-gradient(900px 420px at 90% 10%, rgba(34,197,94,.22), transparent 55%),
                    linear-gradient(180deg, rgba(2,6,23,.55), rgba(2,6,23,.25));
        border: 1px solid rgba(148,163,184,.18);
        box-shadow: 0 18px 50px rgba(0,0,0,.28)}
      [data-theme="light"] .vs-hero{background: radial-gradient(1200px 420px at 10% 0%, rgba(51,105,30,.18), transparent 60%),
                    radial-gradient(900px 420px at 90% 10%, rgba(34,197,94,.12), transparent 55%),
                    linear-gradient(180deg, rgba(255,255,255,.9), rgba(255,255,255,.78));
        box-shadow: 0 18px 50px rgba(2,6,23,.08)}
      .vs-hero__top{display:flex; justify-content:space-between; gap:16px; align-items:flex-start; flex-wrap:wrap}
      .vs-hero__eyebrow{font-size:12px; letter-spacing:.14em; text-transform:uppercase; color: var(--vs-muted); margin-bottom:8px}
      .vs-hero__title{font-size:28px; line-height:1.05; margin:0; font-weight:800}
      .vs-hero__sub{margin-top:10px; color: var(--vs-muted); max-width: 62ch}
      .vs-hero__meta{display:flex; gap:10px; flex-wrap:wrap}
      .vs-metaCard{min-width:160px; padding:12px 14px; border-radius:14px; background: rgba(15,23,42,.45);
        border:1px solid rgba(148,163,184,.16)}
      [data-theme="light"] .vs-metaCard{background: rgba(255,255,255,.78)}
      .vs-metaCard__label{font-size:12px; color: var(--vs-muted); margin-bottom:6px}
      .vs-metaCard__value{font-weight:800}
      .vs-kpis{display:grid; grid-template-columns: repeat(4, minmax(0,1fr)); gap:12px; margin-top:14px}
      @media (max-width: 1100px){.vs-kpis{grid-template-columns: repeat(2, minmax(0,1fr));}}
      @media (max-width: 560px){.vs-kpis{grid-template-columns: 1fr;}}
      .vs-kpi{padding:14px; border-radius:16px; background: rgba(15,23,42,.38);
        border:1px solid rgba(148,163,184,.16); position:relative; overflow:hidden}
      .vs-kpi:before{content:""; position:absolute; inset:-2px -2px auto auto; width:120px; height:120px;
        background: radial-gradient(circle at 40% 40%, rgba(34,197,94,.35), transparent 55%); transform: translate(22px,-22px)}
      [data-theme="light"] .vs-kpi{background: rgba(255,255,255,.78)}
      .vs-kpi__label{font-size:12px; color: var(--vs-muted); letter-spacing:.08em; text-transform:uppercase}
      .vs-kpi__value{font-size:30px; font-weight:900; margin-top:8px}
      .vs-kpi__hint{margin-top:6px; color: var(--vs-muted); font-size:12px}
      .vs-hero__note{display:grid; grid-template-columns: 1.25fr .95fr; gap:12px; margin-top:12px}
      @media (max-width: 900px){.vs-hero__note{grid-template-columns: 1fr;}}
      .vs-note{padding:14px; border-radius:16px; background: rgba(15,23,42,.30); border:1px solid rgba(148,163,184,.14)}
      [data-theme="light"] .vs-note{background: rgba(255,255,255,.78)}
      .vs-note__title{font-weight:900; margin-bottom:6px}
      .vs-note__text{color: var(--vs-muted)}
      .vs-card{padding:14px; border-radius:16px; background: rgba(15,23,42,.30); border:1px solid rgba(148,163,184,.14)}
      [data-theme="light"] .vs-card{background: rgba(255,255,255,.78)}
      .vs-card__title{font-weight:900; margin-bottom:10px}
      .vs-bullets{margin:0; padding-left: 18px; color: var(--vs-text)}
      .vs-bullets li{margin: 6px 0; color: var(--vs-muted)}
      .vs-steps{margin:0; padding-left:18px}
      .vs-steps li{margin: 8px 0; color: var(--vs-muted)}
      .vs-chips{display:flex; flex-wrap:wrap; gap:8px}
      .vs-chip{padding:6px 10px; border-radius:999px; font-size:12px; border:1px solid rgba(148,163,184,.18);
        background: rgba(2,6,23,.35)}
      [data-theme="light"] .vs-chip{background: rgba(255,255,255,.85)}
      .vs-sbomBox{display:grid; gap:8px}
      .vs-sbomLine{display:flex; justify-content:space-between; gap:10px}
      .vs-sbomNote{margin-top:6px; font-size:12px; color: var(--vs-muted)}
      /* Drawer + modal */
      .vs-drawer, .vs-modal{position:fixed; inset:0; z-index:9999; display:none}
      .vs-drawer[aria-hidden="false"], .vs-modal[aria-hidden="false"]{display:block}
      .vs-drawer__backdrop, .vs-modal__backdrop{position:absolute; inset:0; background: rgba(0,0,0,.55)}
      .vs-drawer__panel{position:absolute; right:0; top:0; height:100%; width:min(520px, 94vw);
        background: rgba(2,6,23,.92); color: var(--vs-text);
        border-left: 1px solid rgba(148,163,184,.18); box-shadow: -18px 0 60px rgba(0,0,0,.45);
        display:flex; flex-direction:column}
      [data-theme="light"] .vs-drawer__panel{background: rgba(255,255,255,.95); box-shadow: -18px 0 60px rgba(2,6,23,.12)}
      .vs-drawer__header{display:flex; align-items:flex-start; justify-content:space-between; padding:16px 16px 10px; gap:12px}
      .vs-drawer__title{font-size:18px; font-weight:900}
      .vs-drawer__subtitle{color: var(--vs-muted); margin-top:4px}
      .vs-drawer__body{padding: 0 16px 16px; overflow:auto}
      .vs-drawer__footer{padding: 12px 16px 16px; display:flex; gap:10px; border-top:1px solid rgba(148,163,184,.14)}
      .vs-kpiRow{display:grid; grid-template-columns: repeat(3,1fr); gap:10px; margin-bottom:12px}
      .vs-kpiMini{padding:10px 12px; border-radius:14px; background: rgba(15,23,42,.40); border:1px solid rgba(148,163,184,.14)}
      [data-theme="light"] .vs-kpiMini{background: rgba(255,255,255,.8)}
      .vs-kpiMini__label{font-size:11px; color: var(--vs-muted); text-transform:uppercase; letter-spacing:.10em}
      .vs-kpiMini__value{margin-top:6px; font-weight:900}
      .vs-modal__panel{position:absolute; left:50%; top:50%; transform:translate(-50%,-50%); width:min(760px, 94vw);
        background: rgba(2,6,23,.92); border:1px solid rgba(148,163,184,.18); border-radius: 18px;
        box-shadow: 0 22px 80px rgba(0,0,0,.55)}
      [data-theme="light"] .vs-modal__panel{background: rgba(255,255,255,.95); box-shadow: 0 22px 80px rgba(2,6,23,.12)}
      .vs-modal__header{display:flex; justify-content:space-between; gap:12px; align-items:flex-start; padding:16px 16px 10px}
      .vs-modal__title{font-weight:900; font-size:18px}
      .vs-modal__body{padding: 0 16px 16px}
      .vs-modal__lead{color: var(--vs-muted); margin-top:0}
      .vs-grid2{display:grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap:12px; margin:12px 0}
      @media (max-width: 780px){.vs-grid2{grid-template-columns:1fr}}
      .vs-ctaRow{display:flex; flex-wrap:wrap; gap:10px; margin-top:8px}
      .vs-small{font-size:12px}


/* --- VendorSoluce Dashboard Enhancements (v8) --- */
.vs-dashboard{max-width:1200px;margin:18px auto 40px;padding:0 18px}
.vs-dashboard__header{
  display:flex;flex-direction:column;gap:6px;
  padding:16px 18px;border:1px solid var(--border);
  background:linear-gradient(135deg, rgba(51,105,30,.14), rgba(0,0,0,0));
  border-radius:18px;box-shadow: var(--shadow);
}
html.dark .vs-dashboard__header{background:linear-gradient(135deg, rgba(102,187,106,.10), rgba(0,0,0,0));}
.vs-dashboard__title{font-size:18px;font-weight:800;letter-spacing:.2px}
.vs-dashboard__subtitle{font-size:13px;opacity:.82}

.radar-panel{position:relative}
.panel-title{
  display:flex;align-items:center;justify-content:space-between;gap:10px;
  cursor:pointer; user-select:none;
}
.panel-title:focus{outline:2px solid rgba(51,105,30,.35); outline-offset:3px; border-radius:10px;}
.panel-title .panel-chev{opacity:.75; font-size:14px; transition: transform .18s ease, opacity .18s ease;}
.radar-panel.collapsed .panel-chev{transform: rotate(-90deg); opacity:.9;}
.radar-panel.collapsed > :not(.panel-title){display:none !important;}

.vs-kpi{border:1px solid var(--border); background:var(--surface); box-shadow: var(--shadow);}
html.dark .vs-kpi{background:rgba(255,255,255,.06);}

.toolbar button.secondary{border:1px solid var(--border); background:var(--surface-2);}
html.dark .toolbar button.secondary{background:rgba(255,255,255,.06);}
</style>
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<meta content="Vendor risk radar demo aligned with NIST SP 800-161. Import vendors (CSV/Excel), prioritize critical risk, and surface SBOM gaps." name="description"/>
<script>
/* VendorSoluce dual-theme (light/dark)
   - Respects system preference by default
   - Persists only when user explicitly toggles
   - Drives both: html.classList ('dark') AND data-theme attribute for CSS hooks
*/
(function () {
  const STORAGE_KEY = 'vs_theme'; // avoid collisions

  const systemTheme = () =>
    window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';

  const getTheme = () => localStorage.getItem(STORAGE_KEY) || systemTheme();

  const setDomTheme = (theme) => {
    const root = document.documentElement;
    root.dataset.theme = theme;
    root.classList.toggle('dark', theme === 'dark');
    // update buttons (may exist multiple times)
    document.querySelectorAll('[data-theme-toggle]').forEach((btn) => {
      const sun = btn.querySelector('.lucide-sun');
      const moon = btn.querySelector('.lucide-moon');
      if (sun) sun.style.display = theme === 'dark' ? 'block' : 'none';
      if (moon) moon.style.display = theme === 'dark' ? 'none' : 'block';
      btn.setAttribute('aria-label', theme === 'dark' ? 'Switch to light mode' : 'Switch to dark mode');
    });
  };

  const apply = (theme, { persist } = { persist: false }) => {
    if (persist) localStorage.setItem(STORAGE_KEY, theme);
    setDomTheme(theme);
  };

  // Apply ASAP (no persistence unless user already chose)
  const stored = localStorage.getItem(STORAGE_KEY);
  apply(stored || systemTheme(), { persist: !!stored });

  document.addEventListener('DOMContentLoaded', () => {
    // Wire toggles
    document.querySelectorAll('[data-theme-toggle]').forEach((btn) => {
      btn.addEventListener('click', () => {
        const current = getTheme();
        const next = current === 'dark' ? 'light' : 'dark';
        apply(next, { persist: true });
      });
    });

    // System changes (only if user hasn't pinned a theme)
    if (window.matchMedia) {
      const mq = window.matchMedia('(prefers-color-scheme: dark)');
      const onChange = (e) => {
        if (!localStorage.getItem(STORAGE_KEY)) {
          apply(e.matches ? 'dark' : 'light', { persist: false });
        }
      };
      if (typeof mq.addEventListener === 'function') mq.addEventListener('change', onChange);
      else if (typeof mq.addListener === 'function') mq.addListener(onChange);
    }
  });
})();
</script>
<style id="vendorsoluce-vendor-catalog-css">
  .vs-modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.55);display:none;align-items:center;justify-content:center;z-index:9999;padding:16px}
  .vs-modal{width:min(1100px,100%);max-height:86vh;overflow:auto;border-radius:18px;box-shadow:0 20px 70px rgba(0,0,0,.35);border:1px solid rgba(255,255,255,.08)}
  html:not(.dark) .vs-modal{background:#fff;border-color:rgba(0,0,0,.08)}
  html.dark .vs-modal{background:rgba(12,22,16,.98)}
  .vs-modal header{position:sticky;top:0;backdrop-filter:saturate(180%) blur(12px);padding:14px 16px;border-bottom:1px solid rgba(127,127,127,.18);display:flex;align-items:center;justify-content:space-between;gap:12px}
  .vs-modal h3{margin:0;font-size:16px;font-weight:750;letter-spacing:.2px}
  .vs-modal .vs-close{appearance:none;border:1px solid rgba(127,127,127,.25);background:transparent;border-radius:12px;padding:8px 10px;cursor:pointer}
  .vs-modal .vs-body{padding:16px}
  .vs-grid{display:grid;grid-template-columns: 320px 1fr;gap:16px}
  @media (max-width: 980px){.vs-grid{grid-template-columns:1fr}}
  .vs-card{border-radius:16px;border:1px solid rgba(127,127,127,.18);padding:14px}
  html:not(.dark) .vs-card{background:linear-gradient(180deg, rgba(51,105,30,.06), rgba(0,0,0,0));}
  html.dark .vs-card{background:linear-gradient(180deg, rgba(51,105,30,.12), rgba(0,0,0,0));}
  .vs-field{display:flex;flex-direction:column;gap:6px;margin-bottom:12px}
  .vs-field label{font-size:12px;opacity:.8}
  .vs-input,.vs-select{padding:10px 12px;border-radius:12px;border:1px solid rgba(127,127,127,.25);background:transparent}
  html:not(.dark) .vs-input, html:not(.dark) .vs-select{background:#fff}
  .vs-row{display:flex;gap:10px;flex-wrap:wrap}
  .vs-pill{display:inline-flex;align-items:center;gap:8px;border:1px solid rgba(127,127,127,.22);border-radius:999px;padding:7px 10px;font-size:12px}
  .vs-btn{appearance:none;border:1px solid rgba(127,127,127,.25);background:transparent;border-radius:12px;padding:10px 12px;cursor:pointer;font-weight:650}
  .vs-btn.primary{border-color:rgba(51,105,30,.55)}
  html:not(.dark) .vs-btn.primary{background:rgba(51,105,30,.10)}
  html.dark .vs-btn.primary{background:rgba(51,105,30,.18)}
  .vs-table{width:100%;border-collapse:separate;border-spacing:0 10px}
  .vs-table th{font-size:12px;text-align:left;opacity:.75;padding:0 10px}
  .vs-table td{padding:12px 10px;border-top:1px solid rgba(127,127,127,.18);border-bottom:1px solid rgba(127,127,127,.18)}
  .vs-table tr td:first-child{border-left:1px solid rgba(127,127,127,.18);border-top-left-radius:14px;border-bottom-left-radius:14px}
  .vs-table tr td:last-child{border-right:1px solid rgba(127,127,127,.18);border-top-right-radius:14px;border-bottom-right-radius:14px}
  .vs-muted{opacity:.75;font-size:12px}
  .vs-badge{display:inline-flex;align-items:center;border-radius:999px;padding:4px 9px;font-size:12px;border:1px solid rgba(51,105,30,.45)}
  .vs-stepper{display:flex;gap:8px;flex-wrap:wrap}
  .vs-step{padding:7px 10px;border-radius:999px;border:1px solid rgba(127,127,127,.22);font-size:12px}
  .vs-step.active{border-color:rgba(51,105,30,.55)}
  .vs-alert{border-radius:14px;border:1px solid rgba(127,127,127,.18);padding:10px 12px;font-size:12px}
  html:not(.dark) .vs-alert{background:rgba(51,105,30,.06)}
  html.dark .vs-alert{background:rgba(51,105,30,.12)}
</style>
</head>
<body>
<header class="vs-header">
<div class="vs-header__inner">
<a class="vs-brand" href="#">
<span aria-hidden="true" class="vs-brand__logo">
<svg fill="none" height="32" viewbox="0 0 64 64" width="32" xmlns="http://www.w3.org/2000/svg">
<path d="M32 4l22 10v17c0 15-10 25-22 29C20 56 10 46 10 31V14L32 4z" stroke="currentColor" stroke-width="2.5"></path>
<path d="M22 33c3-8 17-8 20 0" stroke="currentColor" stroke-linecap="round" stroke-width="2.5"></path>
<circle cx="24" cy="25" fill="currentColor" r="2.5"></circle>
<circle cx="40" cy="25" fill="currentColor" r="2.5"></circle>
</svg>
</span>
<span class="vs-brand__text">
<span class="vs-brand__line1">VendorSoluce</span>
<span class="vs-brand__line2">Supply Chain Assurance</span>
<span class="vs-brand__line3">Vendor Risk Intelligence</span>
</span>
</a>
<nav class="bg-white dark:bg-gray-800 shadow-sm sticky top-0 z-50">
<div class="max-w-7xl mx-auto px-2 sm:px-4 lg:px-8 w-full">
<div class="flex items-center justify-between h-16 w-full">
<div class="flex items-center flex-shrink-0 min-w-0 md:max-w-none max-w-[calc(100%-60px)]">
<a class="flex items-center min-w-0 group" href="index.html"><img alt="VendorSoluce Logo" class="h-7 w-7 sm:h-8 sm:w-8 md:h-9 md:w-9 flex-shrink-0 transition-transform group-hover:scale-105" src="data:image/svg+xml;utf8,%3Csvg%20width%3D%2232%22%20height%3D%2232%22%20viewBox%3D%220%200%2064%2064%22%20fill%3D%22none%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20aria-hidden%3D%22true%22%3E%0A%3Cpath%20d%3D%22M32%204l22%2010v18c0%2016-10.2%2027.7-22%2031C20.2%2059.7%2010%2048%2010%2032V14L32%204z%22%20fill%3D%22currentColor%22%20opacity%3D%220.12%22/%3E%0A%3Cpath%20d%3D%22M32%207.5l19%208.7V32c0%2014.5-9.3%2025.1-19%2028.1C22.3%2057.1%2013%2046.5%2013%2032V16.2L32%207.5z%22%20stroke%3D%22currentColor%22%20stroke-width%3D%223%22%20/%3E%0A%3Cpath%20d%3D%22M22%2033c4.5-10.5%2015.5-16%2022-12.5%22%20stroke%3D%22currentColor%22%20stroke-width%3D%223%22%20stroke-linecap%3D%22round%22/%3E%0A%3Cpath%20d%3D%22M20.5%2041c7%204.5%2016.5%203.8%2023.5-2%22%20stroke%3D%22currentColor%22%20stroke-width%3D%223%22%20stroke-linecap%3D%22round%22/%3E%0A%3Ccircle%20cx%3D%2244%22%20cy%3D%2220%22%20r%3D%223.5%22%20fill%3D%22currentColor%22/%3E%0A%3Ccircle%20cx%3D%2218%22%20cy%3D%2242%22%20r%3D%223.5%22%20fill%3D%22currentColor%22/%3E%0A%3C/svg%3E"/><span class="ml-1.5 sm:ml-2 min-w-0"><span class="block text-[10px] sm:text-xs md:text-sm font-bold text-vendorsoluce-green dark:text-white truncate leading-tight">VendorSoluceâ„¢</span><span class="block text-[9px] sm:text-[10px] md:text-[10px] text-vendorsoluce-green/80 text-gray-700 dark:text-vendorsoluce-light-green font-normal leading-tight tracking-tighter" style="letter-spacing: -0.02em; margin-top: -3px;">Supply Chain Assurance</span><span class="block text-[9px] sm:text-[10px] md:text-[10px] text-gray-600 dark:text-gray-400 font-normal leading-tight">by ERMITS</span></span></a>
</div>
<div class="flex items-center gap-2">
<span class="hidden sm:inline-flex items-center text-xs px-2 py-1 rounded-full border border-vendorsoluce-green/20 text-vendorsoluce-green dark:text-vendorsoluce-light-green dark:border-vendorsoluce-green/30 bg-vendorsoluce-pale-green/60 dark:bg-green-900/20">Demo</span>
<button aria-label="Switch to light mode" class="font-medium rounded-md transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 bg-transparent text-vendorsoluce-green hover:bg-vendorsoluce-pale-green focus:ring-vendorsoluce-green/30 dark:text-vendorsoluce-light-green dark:hover:bg-vendorsoluce-green/20 px-3 py-1.5 text-sm cursor-pointer p-2" data-theme-toggle="" type="button"><svg class="lucide lucide-sun h-5 w-5 text-gray-300" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" style="display: none;" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2"></path><path d="M12 20v2"></path><path d="m4.93 4.93 1.41 1.41"></path><path d="m17.66 17.66 1.41 1.41"></path><path d="M2 12h2"></path><path d="M20 12h2"></path><path d="m6.34 17.66-1.41 1.41"></path><path d="m19.07 4.93-1.41 1.41"></path></svg><svg class="lucide lucide-moon h-5 w-5 text-gray-300" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path></svg></button>
</div>
</div>
</div>
</nav>
<section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-6">
<div class="rounded-2xl border border-vendorsoluce-green/15 dark:border-vendorsoluce-green/30 bg-white/70 dark:bg-gray-900/30 backdrop-blur-sm shadow-sm overflow-hidden">
<div class="p-5 sm:p-6 flex flex-col gap-4">
<div class="flex items-center justify-between gap-3">
<div class="text-xs text-gray-500 dark:text-gray-400">
<span class="font-medium text-vendorsoluce-green dark:text-vendorsoluce-light-green">VendorSoluce</span>
<span class="mx-1">/</span>
<span>Vendor Risk Radar</span>
</div>
<span class="text-[11px] px-2 py-1 rounded-full border border-vendorsoluce-green/20 text-vendorsoluce-green dark:text-vendorsoluce-light-green dark:border-vendorsoluce-green/30 bg-vendorsoluce-pale-green/60 dark:bg-green-900/20">NIST SP 800-161 aligned</span>
</div>
<div>
<h1 class="text-2xl sm:text-3xl font-bold tracking-tight text-gray-900 dark:text-white">
          Vendor Risk Radar
        </h1>
<p class="mt-1 text-sm sm:text-base text-gray-600 dark:text-gray-300 max-w-3xl">
          Import your vendor list (CSV/Excel), surface critical exposure, and flag software suppliers with missing SBOM signals â€” all client-side in demo mode.
        </p>
</div>
</div>
</div>
</section>
<div class="vs-actions">
<button class="btn btn-ghost" id="themeToggle" title="Toggle theme" type="button">
<span aria-hidden="true" class="btn__icon">ðŸŒ“</span>
<span class="btn__text">Theme</span>
</button>
</div>
</div>
</header>
<main class="vs-shell"><!-- Loading Overlay -->
<div class="loading-overlay" id="loadingOverlay">
<div class="loading-radar"></div>
<div class="loading-text">INITIALIZING TPRM SYSTEM...</div>
</div>
<!-- Tooltip -->
<div class="tooltip" id="tooltip">
<div class="tooltip-title" id="tooltipTitle"></div>
<div class="tooltip-content" id="tooltipContent"></div>
</div>
<!-- Add/Edit Vendor Modal -->
<div class="modal" id="vendorModal">
<div class="modal-content">
<div class="modal-header">
<div class="modal-title" id="modalTitle">ADD VENDOR</div>
<div class="modal-close" onclick="closeVendorModal()">âœ•</div>
</div>
<form id="vendorForm">
<div class="form-group">
<label class="form-label">Vendor Name *</label>
<input class="form-input" id="vendorName" required="" type="text"/>
</div>
<div class="form-group">
<label class="form-label">Vendor Category *</label>
<select class="form-input" id="vendorCategory" required="">
<option value="">Select Category</option>
<option value="critical">Critical - Mission Essential</option>
<option value="strategic">Strategic - High Value</option>
<option value="tactical">Tactical - Operational</option>
<option value="commodity">Commodity - Low Impact</option>
</select>
</div>
<div class="form-group">
<label class="form-label">Data in Scope *</label>
<div class="checkbox-group">
<label class="checkbox-label">
<input name="dataType" type="checkbox" value="PII"/> PII
                        </label>
<label class="checkbox-label">
<input name="dataType" type="checkbox" value="PHI"/> PHI
                        </label>
<label class="checkbox-label">
<input name="dataType" type="checkbox" value="Financial"/> Financial
                        </label>
<label class="checkbox-label">
<input name="dataType" type="checkbox" value="IP"/> Intellectual Property
                        </label>
<label class="checkbox-label">
<input name="dataType" type="checkbox" value="Confidential"/> Confidential
                        </label>
<label class="checkbox-label">
<input name="dataType" type="checkbox" value="Public"/> Public Only
                        </label>
</div>
</div>
<div class="form-group">
<label class="form-label">Sector</label>
<select class="form-input" id="vendorSector">
<option value="Cloud Services">Cloud Services</option>
<option value="SaaS">SaaS</option>
<option value="Security">Security</option>
<option value="Infrastructure">Infrastructure</option>
<option value="Collaboration">Collaboration</option>
<option value="Analytics">Analytics</option>
<option value="Financial">Financial Services</option>
<option value="Healthcare">Healthcare</option>
<option value="Consulting">Consulting</option>
<option value="Other">Other</option>
</select>
</div>
<div class="form-group">
<label class="form-label">Location</label>
<select class="form-input" id="vendorLocation">
<option value="United States">United States</option>
<option value="Europe">Europe</option>
<option value="Asia">Asia</option>
<option value="Global">Global</option>
<option value="Other">Other</option>
</select>
</div>
<div class="form-group">
<label class="form-label">Contact Email</label>
<input class="form-input" id="vendorContact" type="email"/>
</div>
<div class="form-group">
<label class="form-label">Notes</label>
<textarea class="form-input" id="vendorNotes"></textarea>
</div>
<div style="display: flex; gap: 15px; justify-content: flex-end;">
<button onclick="closeVendorModal()" type="button">CANCEL</button>
<button class="primary" type="submit">SAVE VENDOR</button>
</div>
</form>
</div>
</div>
<div class="radar-container">
<!-- Header -->
<!-- Page Header + Executive KPIs -->
<section class="vs-hero" id="radar">
<div class="vs-hero__top">
<div>
<div class="vs-hero__eyebrow">VendorSoluce â€¢ Demo Mode</div>
<h1 class="vs-hero__title">Vendor Risk Radar</h1>
<div class="vs-hero__sub">Supply chain risk signal map with SBOM-aware classification (EO 14028 posture signals).</div>
</div>
<div class="vs-hero__meta">
<div class="vs-metaCard">
<div class="vs-metaCard__label">Status</div>
<div class="vs-metaCard__value" id="platformStatus">Operational</div>
</div>
<div class="vs-metaCard">
<div class="vs-metaCard__label">Last refresh</div>
<div class="vs-metaCard__value" id="timestamp">INITIALIZINGâ€¦</div>
</div>
</div>
</div>
<div class="vs-kpis">
<div class="vs-kpi">
<div class="vs-kpi__label">Vendors in view</div>
<div class="vs-kpi__value" id="kpiTotal">0</div>
<div class="vs-kpi__hint">Demo capped at <span id="kpiCap">8</span></div>
</div>
<div class="vs-kpi">
<div class="vs-kpi__label">Critical vendors</div>
<div class="vs-kpi__value" id="kpiCritical">0</div>
<div class="vs-kpi__hint">Top operational exposure</div>
</div>
<div class="vs-kpi">
<div class="vs-kpi__label">SBOM gaps</div>
<div class="vs-kpi__value" id="kpiSbomGaps">0</div>
<div class="vs-kpi__hint">Software vendors without SBOM</div>
</div>
<div class="vs-kpi">
<div class="vs-kpi__label">Highest risk</div>
<div class="vs-kpi__value" id="kpiMaxRisk">0</div>
<div class="vs-kpi__hint">Residual score (0â€“100)</div>
</div>
</div>
<div class="vs-hero__note" id="insights">
<div class="vs-note">
<div class="vs-note__title">EO 14028 signal</div>
<div class="vs-note__text">Vendors that provide software and cannot produce an SBOM are flagged and prioritized for procurement followâ€‘up. This demo shows signal detection; full SBOM ingestion &amp; component risk scoring is a Professional feature.</div>
</div>
<div class="vs-note">
<div class="vs-note__title">What you get in 3 minutes</div>
<div class="vs-note__text">Identify the vendors that can break execution, see the SBOM gaps, and export a defensible narrative for leadership (PDF locked in demo).</div>
</div>
</div>
</section>
<!-- Toolbar -->
<div class="toolbar">
<div class="toolbar-group">
<button id="scanBtn" onclick="scanVendors()">Scan Vendors</button>
<button class="primary" onclick="openAddVendor()">Add Vendor</button>
<label for="importFile">
<button onclick="document.getElementById('importFile').click()">Import CSV</button>
</label>
<input accept=".csv,.xlsx,.xls" id="importFile" onchange="importVendors(event)" type="file"/>
</div>
<div class="toolbar-group">
<select id="categoryFilter" onchange="updateRadar()">
<option value="all">All Categories</option>
<option value="critical">Critical Only</option>
<option value="strategic">Strategic+</option>
<option value="tactical">Tactical+</option>
</select>
<select id="riskFilter" onchange="updateRadar()">
<option value="all">All Risk Levels</option>
<option value="critical">Critical Risk</option>
<option value="high">High Risk+</option>
<option value="medium">Medium Risk+</option>
</select>
</div>
<div class="toolbar-group">
<button class="secondary" onclick="exportVendors()">Export CSV</button>
<button class="secondary" onclick="generateReport()">Generate Report</button>
<button class="secondary" id="expandAllBtn" onclick="VSCollapse.expandAll()" title="Expand dashboard sections">Expand</button><button class="secondary" id="collapseAllBtn" onclick="VSCollapse.collapseAll()" title="Collapse dashboard sections">Collapse</button><button class="secondary" id="themeToggle" onclick="VSTheme.toggle()" title="Toggle light/dark">Theme</button>
</div>
</div>
<!-- Alert Banner -->
<div class="alert-banner" id="alertBanner" style="display: none;">
<div class="alert-icon" id="alertIcon">ðŸš¨</div>
<div class="alert-content">
<div class="alert-title" id="alertTitle">RADAR ALERT</div>
<div class="alert-desc" id="alertDesc">Monitoring vendor landscape...</div>
</div>
</div>
<!-- Stats -->
<div class="stats-grid">
<div class="stat-card">
<div class="stat-label">Total Vendors</div>
<div class="stat-value" id="totalVendors">--</div>
</div>
<div class="stat-card">
<div class="stat-label">Critical Category</div>
<div class="stat-value critical" id="criticalCategoryCount">--</div>
</div>
<div class="stat-card">
<div class="stat-label">Critical Risk</div>
<div class="stat-value critical" id="criticalRiskCount">--</div>
</div>
<div class="stat-card">
<div class="stat-label">High Risk</div>
<div class="stat-value warning" id="highRiskCount">--</div>
</div>
<div class="stat-card">
<div class="stat-label">With PII/PHI</div>
<div class="stat-value warning" id="sensitiveDataCount">--</div>
</div>
<div class="stat-card">
<div class="stat-label">Avg Inherent Risk</div>
<div class="stat-value" id="avgInherentRisk">--</div>
</div>
</div>
<!-- Main Radar and Category Distribution -->
<div class="radar-grid">
<div class="radar-display">
<div class="panel-title">VENDOR RISK SCAN</div>
<div class="vs-dashboard"><div class="vs-dashboard__header"><div class="vs-dashboard__title">Dashboard</div><div class="vs-dashboard__subtitle">Interactive vendor prioritization, SBOM signals, and risk analytics (demo mode)</div></div><div class="radar-screen" id="radarScreen">
<div class="radar-grid-lines">
<div class="radar-circle"></div>
<div class="radar-circle"></div>
<div class="radar-circle"></div>
<div class="radar-circle"></div>
<div class="radar-line"></div>
<div class="radar-line"></div>
<div class="radar-line"></div>
<div class="radar-line"></div>
</div>
<div class="radar-sweep"></div>
</div></div>
<div class="radar-legend">
<div class="legend-item">
<div class="legend-dot" style="background: #ff0000;"></div>
<span>CRITICAL (90-100)</span>
</div>
<div class="legend-item">
<div class="legend-dot" style="background: #ff6600;"></div>
<span>HIGH (70-89)</span>
</div>
<div class="legend-item">
<div class="legend-dot" style="background: #ffaa00;"></div>
<span>MEDIUM (40-69)</span>
</div>
<div class="legend-item">
<div class="legend-dot" style="background: #00ff41;"></div>
<span>LOW (0-39)</span>
</div>
</div>
</div>
<div class="radar-panel">
<div class="panel-title">ðŸ“Š VENDOR CATEGORIZATION</div>
<canvas id="categoryChart"></canvas>
<div style="margin-top: 20px; font-size: 0.85em; opacity: 0.8;">
<div style="margin-bottom: 5px;">ðŸ”´ <strong>Critical:</strong> Mission-essential, single point of failure</div>
<div style="margin-bottom: 5px;">ðŸŸ  <strong>Strategic:</strong> High-value, significant impact</div>
<div style="margin-bottom: 5px;">ðŸ”µ <strong>Tactical:</strong> Operational support, moderate impact</div>
<div style="margin-bottom: 5px;">âšª <strong>Commodity:</strong> Easily replaceable, low impact</div>
</div>
</div>
</div>
<!-- Vendor Lists -->
<div class="radar-grid">
<div class="radar-panel">
<div class="panel-title">âš ï¸ HIGH RISK VENDORS</div>
<div class="vendor-list" id="highRiskList"></div>
</div>
<div class="radar-panel">
<div class="panel-title">ðŸŽ¯ CRITICAL CATEGORY VENDORS</div>
<div class="vendor-list" id="criticalCategoryList"></div>
</div>
</div>
<!-- Data & Risk Analysis -->
<div class="radar-grid">
<div class="radar-panel">
<div class="panel-title">ðŸ”’ DATA IN SCOPE ANALYSIS</div>
<canvas id="dataChart"></canvas>
</div>
<div class="radar-panel">
<div class="panel-title">âš¡ INHERENT RISK DISTRIBUTION</div>
<canvas id="inherentRiskChart"></canvas>
</div>
</div>
<!-- Additional Charts -->
<div class="radar-grid">
<div class="radar-panel">
<div class="panel-title">ðŸ­ VENDOR SECTORS</div>
<canvas id="sectorChart"></canvas>
</div>
<div class="radar-panel">
<div class="panel-title">ðŸŒ GEOGRAPHIC DISTRIBUTION</div>
<canvas id="geoChart"></canvas>
</div>
</div>
</div>
<script>
        // Vendor categorization framework
        const VENDOR_CATEGORIES = {
            critical: {
                name: 'Critical',
                description: 'Mission-essential, single point of failure',
                inherentRiskMultiplier: 1.5,
                color: '#ff0000'
            },
            strategic: {
                name: 'Strategic',
                description: 'High-value, significant impact',
                inherentRiskMultiplier: 1.3,
                color: '#ffa500'
            },
            tactical: {
                name: 'Tactical',
                description: 'Operational support, moderate impact',
                inherentRiskMultiplier: 1.1,
                color: '#0096ff'
            },
            commodity: {
                name: 'Commodity',
                description: 'Easily replaceable, low impact',
                inherentRiskMultiplier: 0.9,
                color: '#999999'
            }
        };

        // --- VendorSoluce Demo Configuration ---
        const DEMO_MODE = {
            enabled: true,
            maxVendors: 8,
            pdfEnabled: false
        };

        function openUpgrade(reason) {
            const modal = document.getElementById('upgradeModal');
            const backdrop = document.getElementById('upgradeBackdrop');
            const closeBtn = document.getElementById('upgradeCloseBtn');
            const reasonEl = document.getElementById('upgradeReason');
            reasonEl.textContent = reason || 'This action is locked in Demo Mode.';
            modal.setAttribute('aria-hidden', 'false');

            const close = () => modal.setAttribute('aria-hidden', 'true');
            backdrop.onclick = close;
            closeBtn.onclick = close;
            document.addEventListener('keydown', function esc(e){
                if(e.key === 'Escape'){ close(); document.removeEventListener('keydown', esc); }
            });
        }

        function openDrawer(vendor) {
            const drawer = document.getElementById('vendorDrawer');
            const backdrop = document.getElementById('drawerBackdrop');
            const closeBtn = document.getElementById('drawerCloseBtn');
            const secondaryBtn = document.getElementById('drawerSecondaryBtn');

            // Header
            document.getElementById('drawerTitle').textContent = vendor.name || 'Vendor';
            document.getElementById('drawerSubtitle').textContent = `${(VENDOR_CATEGORIES[vendor.category]||{}).name || vendor.category || 'â€”'} â€¢ ${vendor.sector || 'â€”'}`;

            // KPIs
            document.getElementById('drawerRiskLevel').textContent = vendor.riskLevel || 'â€”';
            document.getElementById('drawerScores').textContent = `${Math.round(vendor.inherentRisk || 0)} / ${Math.round(vendor.residualRisk || 0)}`;
            document.getElementById('drawerCriticality').textContent = (VENDOR_CATEGORIES[vendor.category]||{}).name || vendor.category || 'â€”';

            // Rationale
            const rationale = document.getElementById('drawerRationale');
            rationale.innerHTML = '';
            const reasons = buildRationale(vendor);
            reasons.forEach(r => {
                const li = document.createElement('li');
                li.textContent = r;
                rationale.appendChild(li);
            });

            // Data types
            const chips = document.getElementById('drawerDataTypes');
            chips.innerHTML = '';
            (vendor.dataTypes || []).forEach(dt => {
                const span = document.createElement('span');
                span.className = 'vs-chip';
                span.textContent = dt;
                chips.appendChild(span);
            });

            // SBOM
            const sp = vendor.sbomProfile || {};
            document.getElementById('drawerProvidesSoftware').textContent = sp.providesSoftware ? 'Yes' : 'No';
            document.getElementById('drawerSbomAvailable').textContent = sp.sbomAvailable ? 'Yes' : 'No';
            document.getElementById('drawerSbomFormat').textContent = sp.sbomFormat || 'none';
            document.getElementById('drawerOssExposure').textContent = sp.openSourceExposure || 'unknown';

            // Actions
            const actions = document.getElementById('drawerActions');
            actions.innerHTML = '';
            buildNextActions(vendor).forEach(a => {
                const li = document.createElement('li');
                li.textContent = a;
                actions.appendChild(li);
            });

            // CTA
            document.getElementById('drawerCtaBtn').onclick = () => openUpgrade('Request Full Access to unlock exports, unlimited vendors, and full SBOM ingestion.');

            const close = () => { drawer.setAttribute('aria-hidden', 'true'); };
            drawer.setAttribute('aria-hidden', 'false');
            backdrop.onclick = close;
            closeBtn.onclick = close;
            secondaryBtn.onclick = close;
            document.addEventListener('keydown', function esc(e){
                if(e.key === 'Escape'){ close(); document.removeEventListener('keydown', esc); }
            });
        }

        function buildRationale(v) {
            const out = [];
            if ((v.residualRisk || 0) >= 80) out.push('High residual risk with limited mitigation signals.');
            if ((v.inherentRisk || 0) >= 85) out.push('High inherent exposure based on access and dependency.');
            if (v.dataTypes && v.dataTypes.includes('PII')) out.push('Handles PII â€” privacy and breach impact escalates.');
            if (v.dataTypes && v.dataTypes.includes('PHI')) out.push('Handles PHI â€” regulated exposure requires stronger assurance.');
            if (v.category === 'critical') out.push('Critical dependency â€” failure can disrupt core operations.');
            const sp = v.sbomProfile || {};
            if (sp.providesSoftware && !sp.sbomAvailable) out.push('Provides software but does not provide an SBOM (EO 14028 posture gap).');
            if (sp.providesSoftware && sp.sbomAvailable) out.push('Provides software and signals SBOM availability â€” improved supply-chain defensibility.');
            return out.length ? out : ['No specific drivers detected. Add vendor details to strengthen the signal.'];
        }

        function buildNextActions(v) {
            const actions = [];
            const sp = v.sbomProfile || {};
            if (v.category === 'critical') actions.push('Confirm exit plan / redundancy options for this dependency.');
            if (v.dataTypes && (v.dataTypes.includes('PII') || v.dataTypes.includes('PHI'))) actions.push('Validate privacy controls, DPA clauses, and breach notification obligations.');
            if (sp.providesSoftware && !sp.sbomAvailable) actions.push('Request SBOM (SPDX/CycloneDX) and document procurement followâ€‘up.');
            if ((v.residualRisk || 0) >= 80) actions.push('Initiate targeted due diligence and timeâ€‘bound remediation plan.');
            actions.push('Assign an owner and set next review date.');
            return actions;
        }

        function updateKpis(vendors) {
            const total = vendors.length;
            const critical = vendors.filter(v => v.category === 'critical').length;
            const sbomGaps = vendors.filter(v => (v.sbomProfile||{}).providesSoftware && !(v.sbomProfile||{}).sbomAvailable).length;
            const maxRisk = vendors.reduce((m,v) => Math.max(m, Math.round(v.residualRisk||0)), 0);

            const set = (id, val) => { const el=document.getElementById(id); if(el) el.textContent = String(val); };
            set('kpiTotal', total);
            set('kpiCritical', critical);
            set('kpiSbomGaps', sbomGaps);
            set('kpiMaxRisk', maxRisk);
            set('kpiCap', DEMO_MODE.maxVendors);
        }



        // Data classification risk weights
        const DATA_RISK_WEIGHTS = {
            'PII': 15,
            'PHI': 20,
            'Financial': 18,
            'IP': 16,
            'Confidential': 12,
            'Public': 0
        };

        let vendorData = [];
        let charts = {};
        let currentCategoryFilter = 'all';
        let currentRiskFilter = 'all';
        let editingVendorId = null;

        // Initialize with sample data
        function initializeSampleVendors() {
            return [
                {
                    id: generateId(),
                    name: 'AWS',
                    category: 'critical',
                    dataTypes: ['PII', 'Financial', 'Confidential'],
                    sector: 'Cloud Services',
                    location: 'United States',
                    contact: 'security@aws.amazon.com',
                    notes: 'Primary cloud infrastructure provider'
                },
                {
                    id: generateId(),
                    name: 'Microsoft 365',
                    category: 'critical',
                    dataTypes: ['PII', 'Confidential', 'IP'],
                    sector: 'SaaS',
                    location: 'United States',
                    contact: 'security@microsoft.com',
                    notes: 'Email and productivity suite'
                },
                {
                    id: generateId(),
                    name: 'Salesforce',
                    category: 'strategic',
                    dataTypes: ['PII', 'Financial'],
                    sector: 'SaaS',
                    location: 'United States',
                    contact: 'security@salesforce.com',
                    notes: 'CRM platform'
                },
                {
                    id: generateId(),
                    name: 'Okta',
                    category: 'strategic',
                    dataTypes: ['PII'],
                    sector: 'Security',
                    location: 'United States',
                    contact: 'security@okta.com',
                    notes: 'Identity and access management'
                },
                {
                    id: generateId(),
                    name: 'Zoom',
                    category: 'tactical',
                    dataTypes: ['PII'],
                    sector: 'Collaboration',
                    location: 'United States',
                    contact: 'security@zoom.us',
                    notes: 'Video conferencing'
                },
                {
                    id: generateId(),
                    name: 'Slack',
                    category: 'tactical',
                    dataTypes: ['Confidential'],
                    sector: 'Collaboration',
                    location: 'United States',
                    contact: 'security@slack.com',
                    notes: 'Team messaging'
                },
                {
                    id: generateId(),
                    name: 'DocuSign',
                    category: 'tactical',
                    dataTypes: ['PII', 'Financial'],
                    sector: 'SaaS',
                    location: 'United States',
                    contact: 'security@docusign.com',
                    notes: 'Digital signature platform'
                },
                {
                    id: generateId(),
                    name: 'Office Supplies Co',
                    category: 'commodity',
                    dataTypes: ['Public'],
                    sector: 'Other',
                    location: 'United States',
                    contact: 'sales@officesupplies.com',
                    notes: 'Office supply vendor'
                }
            ];
        }

        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2);
        }

        async function scanVendors() {
            const btn = document.getElementById('scanBtn');
            btn.disabled = true;
            btn.textContent = 'â³ SCANNING...';
            
            document.getElementById('loadingOverlay').style.display = 'flex';
            
            try {
                // Load vendors from localStorage or use sample data
                const saved = localStorage.getItem('vendorData');
                if (!saved || JSON.parse(saved).length === 0) {
                    vendorData = initializeSampleVendors();
                    localStorage.setItem('vendorData', JSON.stringify(vendorData));
                } else {
                    vendorData = JSON.parse(saved);
                }
                
                // Calculate risk scores for each vendor
                vendorData = vendorData.map(vendor => ({
                    ...vendor,
                    ...calculateVendorRisk(vendor)
                }));
                
                updateAllDisplays();
                
                const now = new Date();
                document.getElementById('timestamp').textContent = 
                    `LAST SCAN: ${now.toLocaleString()} â€¢ AUTO-SCAN: 5 MIN`;
            } catch (error) {
                console.error('Scan error:', error);
            }
            
            document.getElementById('loadingOverlay').style.display = 'none';
            btn.disabled = false;
            btn.textContent = 'Scan Vendors';
        }

        
function hashStringToRange(str, min, max){
            let h = 2166136261;
            for (let i = 0; i < str.length; i++){
                h ^= str.charCodeAt(i);
                h = Math.imul(h, 16777619);
            }
            const n = (h >>> 0) / 4294967295; // 0..1
            return min + n * (max - min);
        }

        function detectSBOMProfile(vendor){
            const hay = [
                vendor.name, vendor.sector, vendor.category,
                (vendor.notes||''), (vendor.contact||''),
                ...(vendor.dataTypes||[])
            ].join(' ').toLowerCase();

            const providesSoftware =
                /(saas|software|app|api|platform|cloud|it service|managed service|msps?|mssp|devops|hosting|cdn|repository|package|library|sdk)/i.test(hay) ||
                ['technology','software','it','cloud'].includes((vendor.sector||'').toLowerCase());

            const mentionsSBOM = /(sbom|spdx|cyclonedx)/i.test(hay);
            const format = /spdx/i.test(hay) ? 'SPDX' : (/cyclonedx/i.test(hay) ? 'CycloneDX' : 'none');

            // If the vendor is software-ish but SBOM isn't explicitly present, assume "not provided" in demo mode.
            const sbomAvailable = mentionsSBOM;

            return {
                providesSoftware,
                sbomAvailable,
                sbomFormat: sbomAvailable ? format : 'none'
            };
        }

        function calculateVendorRisk(vendor) {
            const sbom = vendor.sbomProfile ? vendor.sbomProfile : detectSBOMProfile(vendor);
            vendor.sbomProfile = sbom;

            // Base risk
            let inherentRisk = 18;

            // Category multiplier
            const categoryMultiplier = VENDOR_CATEGORIES[vendor.category]?.inherentRiskMultiplier || 1;
            inherentRisk *= categoryMultiplier;

            // Data types weighting
            (vendor.dataTypes || []).forEach(dataType => {
                inherentRisk += DATA_RISK_WEIGHTS[dataType] || 0;
            });

            // SBOM/Supply-chain exposure bump (EO 14028 / modern procurement expectations)
            if (sbom.providesSoftware && !sbom.sbomAvailable) {
                inherentRisk += 15;
            } else if (sbom.providesSoftware && sbom.sbomAvailable) {
                inherentRisk += 4; // still software, but with better hygiene
            }

            // Deterministic residual risk (no Math.random)
            const jitter = hashStringToRange(vendor.name || 'vendor', -8, 8);
            let residualRisk = inherentRisk * 0.88 + jitter;

            // Clamp
            inherentRisk = Math.max(0, Math.min(100, inherentRisk));
            residualRisk = Math.max(0, Math.min(100, residualRisk));

            // Determine risk level
            let riskLevel;
            if (residualRisk >= 90) riskLevel = 'critical';
            else if (residualRisk >= 70) riskLevel = 'high';
            else if (residualRisk >= 40) riskLevel = 'medium';
            else riskLevel = 'low';

            return {
                inherentRisk: Math.round(inherentRisk),
                residualRisk: Math.round(residualRisk),
                riskLevel,
                sbomProfile: sbom
            };
        }


        function updateAllDisplays() {
            updateStats();
            updateAlertBanner();
            updateRadar();
            updateCharts();
        }

        function updateStats() {
            const criticalCategory = vendorData.filter(v => v.category === 'critical').length;
            const criticalRisk = vendorData.filter(v => v.riskLevel === 'critical').length;
            const highRisk = vendorData.filter(v => v.riskLevel === 'high').length;
            const sensitiveData = vendorData.filter(v => 
                v.dataTypes.some(dt => ['PII', 'PHI', 'Financial'].includes(dt))
            ).length;
            const avgInherent = vendorData.length > 0 
                ? (vendorData.reduce((sum, v) => sum + v.inherentRisk, 0) / vendorData.length).toFixed(0)
                : 0;
            
            document.getElementById('totalVendors').textContent = vendorData.length;
            document.getElementById('criticalCategoryCount').textContent = criticalCategory;
            document.getElementById('criticalRiskCount').textContent = criticalRisk;
            document.getElementById('highRiskCount').textContent = highRisk;
            document.getElementById('sensitiveDataCount').textContent = sensitiveData;
            document.getElementById('avgInherentRisk').textContent = avgInherent;
        }

        function updateAlertBanner() {
            const banner = document.getElementById('alertBanner');
            const icon = document.getElementById('alertIcon');
            const title = document.getElementById('alertTitle');
            const desc = document.getElementById('alertDesc');
            
            const criticalRisk = vendorData.filter(v => v.riskLevel === 'critical');
            const highRisk = vendorData.filter(v => v.riskLevel === 'high');
            const criticalCategory = vendorData.filter(v => v.category === 'critical' && v.riskLevel !== 'low');
            
            banner.style.display = 'flex';
            
            if (criticalRisk.length > 0) {
                banner.className = 'alert-banner critical';
                icon.textContent = 'ðŸš¨';
                title.textContent = 'CRITICAL VENDOR ALERT';
                desc.textContent = `${criticalRisk.length} vendor(s) in critical risk zone. Immediate review required: ${criticalRisk.map(v => v.name).join(', ')}`;
            } else if (criticalCategory.length > 0) {
                banner.className = 'alert-banner warning';
                icon.textContent = 'âš ï¸';
                title.textContent = 'CRITICAL CATEGORY AT RISK';
                desc.textContent = `${criticalCategory.length} mission-critical vendor(s) showing elevated risk. Enhanced monitoring required.`;
            } else if (highRisk.length > 3) {
                banner.className = 'alert-banner warning';
                icon.textContent = 'âš ï¸';
                title.textContent = 'ELEVATED VENDOR RISK';
                desc.textContent = `${highRisk.length} vendors at high risk. Enhanced monitoring recommended.`;
            } else {
                banner.className = 'alert-banner clear';
                icon.textContent = 'âœ…';
                title.textContent = 'VENDOR LANDSCAPE STABLE';
                desc.textContent = 'No critical risks detected. Continue standard vendor monitoring.';
            }
        }

        function updateRadar() {
            currentCategoryFilter = document.getElementById('categoryFilter').value;
            currentRiskFilter = document.getElementById('riskFilter').value;
            
            let filteredVendors = vendorData;
            
            // Category filter
            if (currentCategoryFilter !== 'all') {
                const categoryMap = {
                    critical: ['critical'],
                    strategic: ['critical', 'strategic'],
                    tactical: ['critical', 'strategic', 'tactical']
                };
                filteredVendors = filteredVendors.filter(v => categoryMap[currentCategoryFilter].includes(v.category));
            }
            
            // Risk filter
            if (currentRiskFilter !== 'all') {
                const riskMap = {
                    critical: ['critical'],
                    high: ['critical', 'high'],
                    medium: ['critical', 'high', 'medium']
                };
                filteredVendors = filteredVendors.filter(v => riskMap[currentRiskFilter].includes(v.riskLevel));
            }
            
            updateRadarBlips(filteredVendors);
            updateVendorLists();
        }

        function updateRadarBlips(vendors) {
            const screen = document.getElementById('radarScreen');
            
            // Remove old blips
            document.querySelectorAll('.radar-blip').forEach(b => b.remove());
            
            // Add new blips
            vendors.forEach((vendor, index) => {
                const blip = document.createElement('div');
                blip.className = `radar-blip ${vendor.riskLevel}`;
                
                // Position based on risk (closer to center = higher risk)
                const angle = (index / vendors.length) * 360;
                const distance = (100 - vendor.residualRisk) * 0.45;
                
                const x = 50 + distance * Math.cos(angle * Math.PI / 180);
                const y = 50 + distance * Math.sin(angle * Math.PI / 180);
                
                blip.style.left = x + '%';
                blip.style.top = y + '%';
                
                blip.addEventListener('mouseenter', (e) => showTooltip(e, vendor));
                blip.addEventListener('mouseleave', hideTooltip);
                blip.addEventListener('mousemove', (e) => moveTooltip(e));
                blip.addEventListener('click', () => openDrawer(vendor));
                
                screen.appendChild(blip);
            });
        }

        function showTooltip(e, vendor) {
            const tooltip = document.getElementById('tooltip');
            const categoryName = VENDOR_CATEGORIES[vendor.category]?.name || vendor.category;
            
            document.getElementById('tooltipTitle').textContent = vendor.name;
            document.getElementById('tooltipContent').innerHTML = `
                <div class="tooltip-row"><span>Category:</span><strong>${categoryName}</strong></div>
                <div class="tooltip-row"><span>Inherent Risk:</span><strong>${vendor.inherentRisk}/100</strong></div>
                <div class="tooltip-row"><span>Residual Risk:</span><strong>${vendor.residualRisk}/100</strong></div>
                <div class="tooltip-row"><span>Risk Level:</span><strong>${vendor.riskLevel.toUpperCase()}</strong></div>
                <div class="tooltip-row"><span>Sector:</span><strong>${vendor.sector}</strong></div>
                <div class="tooltip-row"><span>Data Types:</span><strong>${vendor.dataTypes.join(', ')}</strong></div>
            `;
            tooltip.classList.add('show');
            moveTooltip(e);
        }

        function hideTooltip() {
            document.getElementById('tooltip').classList.remove('show');
        }

        function moveTooltip(e) {
            const tooltip = document.getElementById('tooltip');
            tooltip.style.left = (e.pageX + 15) + 'px';
            tooltip.style.top = (e.pageY + 15) + 'px';
        }

        function updateVendorLists() {
            // High Risk Vendors
            const highRisk = vendorData
                .filter(v => v.riskLevel === 'critical' || v.riskLevel === 'high')
                .sort((a, b) => b.residualRisk - a.residualRisk)
                .slice(0, 10);
            
            const highRiskList = document.getElementById('highRiskList');
            highRiskList.innerHTML = highRisk.length > 0 ? highRisk.map(vendor => createVendorCard(vendor)).join('') 
                : '<div style="text-align: center; padding: 40px; opacity: 0.7;">No high-risk vendors detected</div>';
            
            // Critical Category Vendors
            const criticalCategory = vendorData
                .filter(v => v.category === 'critical')
                .sort((a, b) => b.residualRisk - a.residualRisk);
            
            const criticalList = document.getElementById('criticalCategoryList');
            criticalList.innerHTML = criticalCategory.length > 0 ? criticalCategory.map(vendor => createVendorCard(vendor)).join('')
                : '<div style="text-align: center; padding: 40px; opacity: 0.7;">No critical vendors defined</div>';
        }

        function createVendorCard(vendor) {
            const categoryName = VENDOR_CATEGORIES[vendor.category]?.name || vendor.category;
            const dataTypeTags = vendor.dataTypes.map(dt => 
                `<span class="tag data-${dt.toLowerCase()}">${dt}</span>`
            ).join('');
            
            return `
                <div class="vendor-item ${vendor.riskLevel}">
                    <div class="vendor-header">
                        <div class="vendor-name">${vendor.name}</div>
                        <div class="vendor-badges">
                            <div class="vendor-badge category-${vendor.category}">${categoryName}</div>
                            <div class="vendor-score ${vendor.riskLevel}">${vendor.residualRisk}/100</div>
                        </div>
                    </div>
                    <div class="vendor-details">
                        ${vendor.sector} â€¢ ${vendor.location}<br>
                        Inherent Risk: ${vendor.inherentRisk}/100 | Residual Risk: ${vendor.residualRisk}/100
                    </div>
                    <div class="vendor-tags">
                        ${dataTypeTags}
                    </div>
                </div>
            `;
        }

        function updateCharts() {
            // Category Distribution
            const categoryCtx = document.getElementById('categoryChart');
            if (charts.category) charts.category.destroy();
            
            const categoryCounts = {
                'Critical': vendorData.filter(v => v.category === 'critical').length,
                'Strategic': vendorData.filter(v => v.category === 'strategic').length,
                'Tactical': vendorData.filter(v => v.category === 'tactical').length,
                'Commodity': vendorData.filter(v => v.category === 'commodity').length
            };
            
            charts.category = new Chart(categoryCtx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(categoryCounts).map(k => `${k} (${categoryCounts[k]})`),
                    datasets: [{
                        data: Object.values(categoryCounts),
                        backgroundColor: ['#ff0000', '#ffa500', '#0096ff', '#999999'],
                        borderColor: '#0a0e27',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { color: '#00ff41', padding: 15 }
                        }
                    }
                }
            });
            
            // Data in Scope
            const dataCtx = document.getElementById('dataChart');
            if (charts.data) charts.data.destroy();
            
            const dataTypes = ['PII', 'PHI', 'Financial', 'IP', 'Confidential', 'Public'];
            const dataCounts = dataTypes.map(dt => 
                vendorData.filter(v => v.dataTypes.includes(dt)).length
            );
            
            charts.data = new Chart(dataCtx, {
                type: 'bar',
                data: {
                    labels: dataTypes,
                    datasets: [{
                        label: 'Vendors with Data Type',
                        data: dataCounts,
                        backgroundColor: ['#ff0000', '#ff6464', '#ffc800', '#c800ff', '#0096ff', '#00ff41'],
                        borderColor: '#00ff41',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { color: '#00ff41' },
                            grid: { color: 'rgba(0, 255, 65, 0.1)' }
                        },
                        x: {
                            ticks: { color: '#00ff41' },
                            grid: { display: false }
                        }
                    }
                }
            });
            
            // Inherent Risk Distribution
            const inherentCtx = document.getElementById('inherentRiskChart');
            if (charts.inherent) charts.inherent.destroy();
            
            const riskBuckets = {
                'Critical (90-100)': vendorData.filter(v => v.inherentRisk >= 90).length,
                'High (70-89)': vendorData.filter(v => v.inherentRisk >= 70 && v.inherentRisk < 90).length,
                'Medium (40-69)': vendorData.filter(v => v.inherentRisk >= 40 && v.inherentRisk < 70).length,
                'Low (0-39)': vendorData.filter(v => v.inherentRisk < 40).length
            };
            
            charts.inherent = new Chart(inherentCtx, {
                type: 'pie',
                data: {
                    labels: Object.keys(riskBuckets),
                    datasets: [{
                        data: Object.values(riskBuckets),
                        backgroundColor: ['#ff0000', '#ff6600', '#ffaa00', '#00ff41'],
                        borderColor: '#0a0e27',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { color: '#00ff41', padding: 10 }
                        }
                    }
                }
            });
            
            // Sector Distribution
            const sectorCtx = document.getElementById('sectorChart');
            if (charts.sector) charts.sector.destroy();
            
            const sectors = {};
            vendorData.forEach(v => {
                sectors[v.sector] = (sectors[v.sector] || 0) + 1;
            });
            
            charts.sector = new Chart(sectorCtx, {
                type: 'bar',
                data: {
                    labels: Object.keys(sectors),
                    datasets: [{
                        label: 'Vendors',
                        data: Object.values(sectors),
                        backgroundColor: 'rgba(0, 255, 65, 0.3)',
                        borderColor: '#00ff41',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { color: '#00ff41' },
                            grid: { color: 'rgba(0, 255, 65, 0.1)' }
                        },
                        x: {
                            ticks: { color: '#00ff41' },
                            grid: { display: false }
                        }
                    }
                }
            });
            
            // Geographic Distribution
            const geoCtx = document.getElementById('geoChart');
            if (charts.geo) charts.geo.destroy();
            
            const locations = {};
            vendorData.forEach(v => {
                locations[v.location] = (locations[v.location] || 0) + 1;
            });
            
            charts.geo = new Chart(geoCtx, {
                type: 'pie',
                data: {
                    labels: Object.keys(locations),
                    datasets: [{
                        data: Object.values(locations),
                        backgroundColor: ['#ff0000', '#ff6600', '#ffaa00', '#00ff41'],
                        borderColor: '#0a0e27',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { color: '#00ff41', padding: 10 }
                        }
                    }
                }
            });
        }

        // Vendor Management Functions
        function openAddVendor() {
            editingVendorId = null;
            document.getElementById('modalTitle').textContent = 'ADD VENDOR';
            document.getElementById('vendorForm').reset();
            document.getElementById('vendorModal').classList.add('show');
        }

        function closeVendorModal() {
            document.getElementById('vendorModal').classList.remove('show');
            editingVendorId = null;
        }

        document.getElementById('vendorForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = {
                id: editingVendorId || generateId(),
                name: document.getElementById('vendorName').value,
                category: document.getElementById('vendorCategory').value,
                dataTypes: Array.from(document.querySelectorAll('input[name="dataType"]:checked')).map(cb => cb.value),
                sector: document.getElementById('vendorSector').value,
                location: document.getElementById('vendorLocation').value,
                contact: document.getElementById('vendorContact').value,
                notes: document.getElementById('vendorNotes').value
            };
            
            if (editingVendorId) {
                const index = vendorData.findIndex(v => v.id === editingVendorId);
                if (index !== -1) {
                    vendorData[index] = { ...vendorData[index], ...formData };
                }
            } else {
                vendorData.push(formData);
            }
            
            // Recalculate risks
            vendorData = vendorData.map(vendor => ({
                ...vendor,
                ...calculateVendorRisk(vendor)
            }));
            
            localStorage.setItem('vendorData', JSON.stringify(vendorData));
            updateAllDisplays();
            closeVendorModal();
        });

        // Import/Export Functions
        
function normalizeHeader(h){
            return (h||'').toString().trim().toLowerCase().replace(/\s+/g,' ').replace(/[^a-z0-9 ]/g,'');
        }

        function mapRowToVendor(row){
            // row is an object with normalized keys
            const name = row['name'] || row['vendor'] || row['vendor name'] || '';
            const category = (row['category'] || row['tier'] || 'tactical').toString().toLowerCase();
            const dataTypesRaw = row['data types'] || row['data'] || row['data types handled'] || '';
            const dataTypes = dataTypesRaw ? dataTypesRaw.toString().split(/;|\||,/).map(s=>s.trim()).filter(Boolean) : [];

            const vendor = {
                name: name.toString().trim(),
                category: ['critical','strategic','tactical','commodity'].includes(category) ? category : 'tactical',
                dataTypes,
                sector: (row['sector'] || row['industry'] || 'Other').toString().trim() || 'Other',
                location: (row['location'] || row['country'] || 'United States').toString().trim() || 'United States',
                contact: (row['contact'] || row['owner'] || row['point of contact'] || '').toString().trim(),
                notes: (row['notes'] || row['comments'] || '').toString().trim(),
                // SBOM fields (optional in import)
                sbomProfile: {
                    providesSoftware: String(row['provides software'] || row['software vendor'] || '').toLowerCase() === 'true',
                    sbomAvailable: String(row['sbom available'] || row['sbom provided'] || '').toLowerCase() === 'true',
                    sbomFormat: (row['sbom format'] || row['format'] || 'none').toString().trim() || 'none'
                }
            };

            // If SBOM fields were not provided, infer them
            const providedAnySBOMField = ['provides software','software vendor','sbom available','sbom provided','sbom format'].some(k => row[k] !== undefined);
            if (!providedAnySBOMField) {
                vendor.sbomProfile = detectSBOMProfile(vendor);
            } else {
                // If providesSoftware is blank but sbomFormat suggests SBOM, infer providesSoftware
                if (!vendor.sbomProfile.providesSoftware && vendor.sbomProfile.sbomFormat && vendor.sbomProfile.sbomFormat.toLowerCase() !== 'none') {
                    vendor.sbomProfile.providesSoftware = true;
                }
            }

            return vendor;
        }

        function importVendors(event) {
            const file = event.target.files && event.target.files[0];
            if (!file) return;

            const filename = (file.name || '').toLowerCase();
            const isXlsx = filename.endsWith('.xlsx') || filename.endsWith('.xls');

            const finishImport = (vendors) => {
                const cleaned = vendors.filter(v => v && v.name);
                vendorData = [...vendorData, ...cleaned].map(v => ({ ...v, ...calculateVendorRisk(v) }));
                localStorage.setItem('vendorData', JSON.stringify(vendorData));
                updateAllDisplays();
                alert(`Successfully imported ${cleaned.length} vendors!`);
                event.target.value = '';
            };

            if (isXlsx && window.XLSX) {
                const reader = new FileReader();
                reader.onload = function(e){
                    try{
                        const data = new Uint8Array(e.target.result);
                        const wb = XLSX.read(data, { type: 'array' });
                        const sheetName = wb.SheetNames[0];
                        const ws = wb.Sheets[sheetName];
                        const json = XLSX.utils.sheet_to_json(ws, { defval: '' });

                        const vendors = json.map(obj => {
                            const row = {};
                            Object.keys(obj).forEach(k => row[normalizeHeader(k)] = obj[k]);
                            return mapRowToVendor(row);
                        });

                        finishImport(vendors);
                    }catch(err){
                        alert('Error importing Excel: ' + err.message);
                    }
                };
                reader.readAsArrayBuffer(file);
                return;
            }

            // CSV fallback (Excel can export CSV)
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const csv = e.target.result || '';
                    const lines = csv.split(/\r?\n/).filter(Boolean);
                    if (!lines.length) return alert('Empty file.');

                    const headers = lines[0].split(',').map(h => normalizeHeader(h));
                    const vendors = [];

                    for (let i = 1; i < lines.length; i++) {
                        const values = lines[i].split(','); // simple CSV; if you need quoted CSV, we can swap to PapaParse
                        const row = {};
                        headers.forEach((h, idx) => row[h] = (values[idx] ?? '').trim());
                        const vendor = mapRowToVendor(row);
                        if (vendor.name) vendors.push(vendor);
                    }

                    finishImport(vendors);
                } catch (error) {
                    alert('Error importing CSV: ' + error.message);
                }
            };
            reader.readAsText(file);
        }


        function exportVendors() {
            const csv = [
                ['Name', 'Category', 'Data Types', 'Sector', 'Location', 'Contact', 'Notes', 'Inherent Risk', 'Residual Risk', 'Risk Level'].join(','),
                ...vendorData.map(v => [
                    v.name,
                    v.category,
                    v.dataTypes.join(';'),
                    v.sector,
                    v.location,
                    v.contact || '',
                    v.notes || '',
                    v.inherentRisk,
                    v.residualRisk,
                    v.riskLevel
                ].join(','))
            ].join('\n');
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `vendor-risk-export-${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            window.URL.revokeObjectURL(url);
        }

        function generateReport() {
            if (DEMO_MODE.enabled && !DEMO_MODE.pdfEnabled) {
                openUpgrade("Executive PDF export is locked in Demo Mode.");
                return;
            }
            alert("Generating PDF report...");
        }

        // Auto-scan
        setInterval(scanVendors, 5 * 60 * 1000);

        
        
// Theme + Collapsible Panels (v8)
window.VSTheme = (function(){
  const KEY = "vendorsoluce_theme";
  let userOverride = null;

  function apply(mode){
    const root = document.documentElement;
    root.dataset.theme = mode;
    if(mode === "dark") root.classList.add("dark");
    else root.classList.remove("dark");
    const btn = document.getElementById("themeToggle");
    if(btn) btn.textContent = (mode === "dark") ? "Dark" : "Light";
  }

  function getSystem(){
    return (window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches) ? "dark" : "light";
  }

  function init(){
    const stored = localStorage.getItem(KEY);
    if(stored === "dark" || stored === "light"){
      userOverride = stored;
      apply(stored);
    } else {
      apply(getSystem());
    }
    // react to system changes only if user hasn't overridden
    if(window.matchMedia){
      const mq = window.matchMedia("(prefers-color-scheme: dark)");
      const handler = () => { if(!userOverride) apply(getSystem()); };
      if(mq.addEventListener) mq.addEventListener("change", handler);
      else if(mq.addListener) mq.addListener(handler);
    }
  }

  function toggle(){
    const current = document.documentElement.dataset.theme || getSystem();
    const next = (current === "dark") ? "light" : "dark";
    userOverride = next;
    localStorage.setItem(KEY, next);
    apply(next);
  }

  return { init, toggle, apply };
})();

window.VSCollapse = (function(){
  function decorate(){
    document.querySelectorAll(".radar-panel .panel-title").forEach((t)=>{
      t.setAttribute("tabindex","0");
      t.setAttribute("role","button");
      if(!t.querySelector(".panel-chev")){
        const chev = document.createElement("span");
        chev.className = "panel-chev";
        chev.textContent = "â–¾";
        t.appendChild(chev);
      }
      const panel = t.closest(".radar-panel");
      const setAria = () => t.setAttribute("aria-expanded", panel && !panel.classList.contains("collapsed") ? "true" : "false");
      setAria();
      t.addEventListener("click", ()=>{ if(panel){ panel.classList.toggle("collapsed"); setAria(); }});
      t.addEventListener("keydown", (e)=>{ if(e.key==="Enter"||e.key===" "){ e.preventDefault(); t.click(); }});
    });
  }
  function collapseAll(){
    document.querySelectorAll(".radar-panel").forEach(p=>p.classList.add("collapsed"));
    document.querySelectorAll(".radar-panel .panel-title").forEach(t=>t.setAttribute("aria-expanded","false"));
  }
  function expandAll(){
    document.querySelectorAll(".radar-panel").forEach(p=>p.classList.remove("collapsed"));
    document.querySelectorAll(".radar-panel .panel-title").forEach(t=>t.setAttribute("aria-expanded","true"));
  }
  function init(){ decorate(); }
  return { init, collapseAll, expandAll };
})();

// Initial scan + init
document.addEventListener("DOMContentLoaded", ()=>{
  try{ window.VSTheme.init(); }catch(e){}
  try{ window.VSCollapse.init(); }catch(e){}
  try{ scanVendors(); }catch(e){}
});
</script>
</main>
<!-- Demo Watermark -->
<div aria-hidden="true" class="vs-watermark">DEMO</div>
<!-- Vendor Drawer -->
<aside aria-hidden="true" aria-label="Vendor details" class="vs-drawer" id="vendorDrawer" role="dialog">
<div class="vs-drawer__backdrop" id="drawerBackdrop"></div>
<div class="vs-drawer__panel" role="document">
<div class="vs-drawer__header">
<div>
<div class="vs-drawer__title" id="drawerTitle">Vendor</div>
<div class="vs-drawer__subtitle" id="drawerSubtitle">Risk profile</div>
</div>
<button aria-label="Close details" class="btn btn-ghost" id="drawerCloseBtn" type="button">
<span aria-hidden="true" class="btn__icon">âœ•</span>
</button>
</div>
<div class="vs-drawer__body">
<div class="vs-kpiRow">
<div class="vs-kpiMini">
<div class="vs-kpiMini__label">Risk Level</div>
<div class="vs-kpiMini__value" id="drawerRiskLevel">â€”</div>
</div>
<div class="vs-kpiMini">
<div class="vs-kpiMini__label">Inherent / Residual</div>
<div class="vs-kpiMini__value" id="drawerScores">â€”</div>
</div>
<div class="vs-kpiMini">
<div class="vs-kpiMini__label">Criticality</div>
<div class="vs-kpiMini__value" id="drawerCriticality">â€”</div>
</div>
</div>
<div class="vs-card">
<div class="vs-card__title">Why this vendor matters</div>
<ul class="vs-bullets" id="drawerRationale"></ul>
</div>
<div class="vs-card">
<div class="vs-card__title">Data access</div>
<div class="vs-chips" id="drawerDataTypes"></div>
</div>
<div class="vs-card">
<div class="vs-card__title">SBOM &amp; Supply Chain Signal</div>
<div class="vs-sbomBox">
<div class="vs-sbomLine"><span class="vs-muted">Provides software:</span> <strong id="drawerProvidesSoftware">â€”</strong></div>
<div class="vs-sbomLine"><span class="vs-muted">SBOM available:</span> <strong id="drawerSbomAvailable">â€”</strong></div>
<div class="vs-sbomLine"><span class="vs-muted">Format:</span> <strong id="drawerSbomFormat">â€”</strong></div>
<div class="vs-sbomLine"><span class="vs-muted">Open source exposure:</span> <strong id="drawerOssExposure">â€”</strong></div>
<div class="vs-sbomNote">EO 14028-ready assessment signals. Full SBOM ingestion &amp; component risk requires the Professional tier.</div>
</div>
</div>
<div class="vs-card">
<div class="vs-card__title">Recommended next actions</div>
<ol class="vs-steps" id="drawerActions"></ol>
</div>
</div>
<div class="vs-drawer__footer">
<button class="btn btn-primary" id="drawerCtaBtn" type="button">Request Full Access</button>
<button class="btn btn-ghost" id="drawerSecondaryBtn" type="button">Back to Radar</button>
</div>
</div>
</aside>
<!-- Upgrade Modal -->
<div aria-hidden="true" aria-label="Upgrade required" class="vs-modal" id="upgradeModal" role="dialog">
<div class="vs-modal__backdrop" id="upgradeBackdrop"></div>
<div class="vs-modal__panel" role="document">
<div class="vs-modal__header">
<div class="vs-modal__title">Unlock Professional</div>
<button aria-label="Close upgrade" class="btn btn-ghost" id="upgradeCloseBtn" type="button">
<span aria-hidden="true" class="btn__icon">âœ•</span>
</button>
</div>
<div class="vs-modal__body">
<p class="vs-modal__lead" id="upgradeReason">This action is locked in Demo Mode.</p>
<div class="vs-grid2">
<div class="vs-card">
<div class="vs-card__title">Professional unlocks</div>
<ul class="vs-bullets">
<li>Unlimited vendors + full register</li>
<li>Executive PDF reports</li>
<li>SBOM &amp; EO 14028 control mapping</li>
<li>Custom risk weights and rationale tuning</li>
</ul>
</div>
<div class="vs-card">
<div class="vs-card__title">Why teams buy</div>
<ul class="vs-bullets">
<li>Procurement-ready defensibility</li>
<li>Focus on the vendors that can break you</li>
<li>Actionable board reporting in minutes</li>
<li>Operational signals, not spreadsheets</li>
</ul>
</div>
</div>
<div class="vs-ctaRow">
<a class="btn btn-primary" href="#pricing" id="upgradePrimaryLink">View Pricing</a>
<a class="btn btn-ghost" href="#contact" id="upgradeSecondaryLink">Request Full Access</a>
</div>
<div class="vs-muted vs-small">Demo Mode is intentionally constrained to protect methodology and prevent â€œfree consulting.â€</div>
</div>
</div>
</div>
<footer class="bg-gray-900 text-white mt-10">
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
<div class="flex flex-col md:flex-row md:items-center md:justify-between gap-6">
<div>
<div class="flex items-center mb-4"><img alt="VendorSoluceâ„¢ " class="h-12 w-12" src="data:image/svg+xml;utf8,%3Csvg%20width%3D%2232%22%20height%3D%2232%22%20viewBox%3D%220%200%2064%2064%22%20fill%3D%22none%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20aria-hidden%3D%22true%22%3E%0A%3Cpath%20d%3D%22M32%204l22%2010v18c0%2016-10.2%2027.7-22%2031C20.2%2059.7%2010%2048%2010%2032V14L32%204z%22%20fill%3D%22currentColor%22%20opacity%3D%220.12%22/%3E%0A%3Cpath%20d%3D%22M32%207.5l19%208.7V32c0%2014.5-9.3%2025.1-19%2028.1C22.3%2057.1%2013%2046.5%2013%2032V16.2L32%207.5z%22%20stroke%3D%22currentColor%22%20stroke-width%3D%223%22%20/%3E%0A%3Cpath%20d%3D%22M22%2033c4.5-10.5%2015.5-16%2022-12.5%22%20stroke%3D%22currentColor%22%20stroke-width%3D%223%22%20stroke-linecap%3D%22round%22/%3E%0A%3Cpath%20d%3D%22M20.5%2041c7%204.5%2016.5%203.8%2023.5-2%22%20stroke%3D%22currentColor%22%20stroke-width%3D%223%22%20stroke-linecap%3D%22round%22/%3E%0A%3Ccircle%20cx%3D%2244%22%20cy%3D%2220%22%20r%3D%223.5%22%20fill%3D%22currentColor%22/%3E%0A%3Ccircle%20cx%3D%2218%22%20cy%3D%2242%22%20r%3D%223.5%22%20fill%3D%22currentColor%22/%3E%0A%3C/svg%3E"/><span class="ml-2"><span class="block text-xl font-bold text-vendorsoluce-green dark:text-white">VendorSoluceâ„¢</span><span class="block text-xs text-vendorsoluce-green/80 dark:text-vendorsoluce-light-green font-normal" style="margin-top: -3px;">A Supply Chain Assurance </span><span class="block text-xs text-gray-600 dark:text-gray-400 font-normal">by ERMITS</span></span></div>
<p class="text-gray-300 text-sm leading-relaxed max-w-2xl">
          Vendor Risk Radar is a decision engine for third-party risk â€” aligned with NIST SP 800-161 and designed to surface critical vendors, SBOM gaps, and execution-ready priorities.
        </p>
</div>
<div class="text-xs text-gray-400">
<div class="mb-1">Client-side demo mode â€¢ No external data collection</div>
<div>Â© <span id="vs-year"></span> VendorSoluceâ„¢ by ERMITS</div>
</div>
</div>
</div>
</footer>
<script>document.getElementById('vs-year').textContent = new Date().getFullYear();</script>
<!-- VendorSoluce Catalog + Wizard + API Mockups (v6) -->
<div aria-label="Vendor Catalog" aria-modal="true" class="vs-modal-backdrop" id="vsCatalogBackdrop" role="dialog">
<div class="vs-modal">
<header>
<div>
<h3>VendorSoluce Catalog</h3>
<div class="vs-muted">150â€“200 common vendors, filterable by industry. Add to your working list in one click.</div>
</div>
<button class="vs-close" onclick="VSUI.close('vsCatalogBackdrop')">Close</button>
</header>
<div class="vs-body">
<div class="vs-grid">
<div class="vs-card">
<div class="vs-field">
<label>Search</label>
<input class="vs-input" id="vsCatalogSearch" placeholder="e.g., Okta, Salesforce, CrowdStrike"/>
</div>
<div class="vs-field">
<label>Industry filter</label>
<select class="vs-select" id="vsCatalogIndustry">
<option value="All">All</option>
<option value="Healthcare">Healthcare</option>
<option value="Financial Services">Financial Services</option>
<option value="Retail">Retail</option>
<option value="Technology">Technology</option>
<option value="Manufacturing">Manufacturing</option>
<option value="SMB">SMB</option>
</select>
</div>
<div class="vs-field">
<label>Category filter</label>
<select class="vs-select" id="vsCatalogCategory">
<option value="All">All</option>
</select>
</div>
<div class="vs-alert" id="vsCatalogHint">
            Tip: Use <span class="vs-badge">Industry templates</span> in the onboarding wizard to preload a realistic stack.
          </div>
<div class="vs-row" style="margin-top:12px">
<button class="vs-btn primary" onclick="VSUI.addSelectedFromCatalog()">Add selected</button>
<button class="vs-btn" onclick="VSUI.selectTopVisible(12)">Select top 12</button>
<button class="vs-btn" onclick="VSUI.clearCatalogSelection()">Clear selection</button>
</div>
</div>
<div class="vs-card">
<div class="vs-row" style="justify-content:space-between;align-items:center;margin-bottom:10px">
<div class="vs-muted"><span id="vsCatalogCount">0</span> vendors shown</div>
<div class="vs-muted">Selected: <span id="vsCatalogSelectedCount">0</span></div>
</div>
<table aria-label="Vendor catalog list" class="vs-table">
<thead>
<tr>
<th style="width:44px"></th>
<th>Vendor</th>
<th>Category</th>
<th>Industries</th>
<th style="width:140px"></th>
</tr>
</thead>
<tbody id="vsCatalogTbody"></tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div aria-label="Vendor Onboarding Wizard" aria-modal="true" class="vs-modal-backdrop" id="vsWizardBackdrop" role="dialog">
<div class="vs-modal">
<header>
<div>
<h3>Vendor Onboarding Wizard</h3>
<div class="vs-muted">Build a vendor list by selecting your industry and tech stack. Takes 2â€“3 minutes.</div>
</div>
<button class="vs-close" onclick="VSUI.close('vsWizardBackdrop')">Close</button>
</header>
<div class="vs-body">
<div class="vs-stepper" id="vsWizardStepper"></div>
<div id="vsWizardContent" style="margin-top:14px"></div>
<div class="vs-row" style="justify-content:space-between;margin-top:14px">
<button class="vs-btn" onclick="VSUI.wizardPrev()">Back</button>
<div class="vs-row">
<button class="vs-btn" onclick="VSUI.wizardSkip()">Skip</button>
<button class="vs-btn primary" onclick="VSUI.wizardNext()">Next</button>
</div>
</div>
</div>
</div>
</div>
<div aria-label="API Integration Mockups" aria-modal="true" class="vs-modal-backdrop" id="vsApiBackdrop" role="dialog">
<div class="vs-modal">
<header>
<div>
<h3>API Integration Mockups</h3>
<div class="vs-muted">Buyer-facing â€œhow it would workâ€ previews for pulling vendor/app assignments from identity providers.</div>
</div>
<button class="vs-close" onclick="VSUI.close('vsApiBackdrop')">Close</button>
</header>
<div class="vs-body">
<div class="vs-grid">
<div class="vs-card">
<div class="vs-field">
<label>Select provider</label>
<select class="vs-select" id="vsApiProvider">
<option value="okta">Okta</option>
<option value="entra">Microsoft Entra ID</option>
<option value="google">Google Workspace</option>
<option value="ping">Ping Identity</option>
<option value="onelogin">OneLogin</option>
</select>
</div>
<div class="vs-field">
<label>What you would pull</label>
<div class="vs-row">
<span class="vs-pill">Assigned apps</span>
<span class="vs-pill">Groups</span>
<span class="vs-pill">SSO metadata</span>
<span class="vs-pill">Owners</span>
</div>
</div>
<div class="vs-alert">
            This is a <b>mock</b>. In production you would use OAuth / SCIM and only store the minimal vendor metadata needed for risk decisions.
          </div>
<div class="vs-row" style="margin-top:12px">
<button class="vs-btn primary" onclick="VSUI.previewApiMock()">Preview mock response</button>
<button class="vs-btn" onclick="VSUI.applyApiMock()">Apply to vendor list</button>
</div>
</div>
<div class="vs-card">
<div class="vs-muted" style="margin-bottom:8px">Example endpoints &amp; mapping (illustrative)</div>
<pre id="vsApiPreview" style="white-space:pre-wrap;line-height:1.35;border:1px solid rgba(127,127,127,.18);border-radius:14px;padding:12px;overflow:auto;max-height:56vh"></pre>
</div>
</div>
</div>
</div>
</div>
<script>
(function(){
  const VS_CATALOG = [{"name": "Amazon Web Services (AWS)", "industries": ["All", "Financial Services", "Retail", "Technology"], "category": "Cloud/Infrastructure", "providesSoftware": true, "notes": ""}, {"name": "Microsoft Azure", "industries": ["All", "Financial Services", "Retail", "Technology"], "category": "Cloud/Infrastructure", "providesSoftware": true, "notes": ""}, {"name": "Google Cloud Platform (GCP)", "industries": ["All", "Financial Services", "Retail", "Technology"], "category": "Cloud/Infrastructure", "providesSoftware": true, "notes": ""}, {"name": "Cloudflare", "industries": ["All", "Financial Services", "Retail", "Technology"], "category": "Cloud/Infrastructure", "providesSoftware": true, "notes": ""}, {"name": "Akamai", "industries": ["All", "Financial Services", "Retail", "Technology"], "category": "Cloud/Infrastructure", "providesSoftware": true, "notes": ""}, {"name": "DigitalOcean", "industries": ["All", "Financial Services", "Retail", "Technology"], "category": "Cloud/Infrastructure", "providesSoftware": true, "notes": ""}, {"name": "Oracle Cloud", "industries": ["All", "Financial Services", "Retail", "Technology"], "category": "Cloud/Infrastructure", "providesSoftware": true, "notes": ""}, {"name": "IBM Cloud", "industries": ["All", "Financial Services", "Retail", "Technology"], "category": "Cloud/Infrastructure", "providesSoftware": true, "notes": ""}, {"name": "Okta", "industries": ["All", "Financial Services", "Healthcare", "Technology"], "category": "Identity & Access", "providesSoftware": true, "notes": ""}, {"name": "Microsoft Entra ID (Azure AD)", "industries": ["All", "Financial Services", "Healthcare", "Technology"], "category": "Identity & Access", "providesSoftware": true, "notes": ""}, {"name": "Google Workspace", "industries": ["All", "Financial Services", "Healthcare", "Technology"], "category": "Identity & Access", "providesSoftware": true, "notes": ""}, {"name": "Ping Identity", "industries": ["All", "Financial Services", "Healthcare", "Technology"], "category": "Identity & Access", "providesSoftware": true, "notes": ""}, {"name": "OneLogin", "industries": ["All", "Financial Services", "Healthcare", "Technology"], "category": "Identity & Access", "providesSoftware": true, "notes": ""}, {"name": "Duo Security", "industries": ["All", "Financial Services", "Healthcare", "Technology"], "category": "Identity & Access", "providesSoftware": true, "notes": ""}, {"name": "Auth0", "industries": ["All", "Financial Services", "Healthcare", "Technology"], "category": "Identity & Access", "providesSoftware": true, "notes": ""}, {"name": "CyberArk", "industries": ["All", "Financial Services", "Healthcare", "Technology"], "category": "Identity & Access", "providesSoftware": true, "notes": ""}, {"name": "Microsoft 365", "industries": ["All"], "category": "Collaboration & Productivity", "providesSoftware": true, "notes": ""}, {"name": "Google Workspace", "industries": ["All"], "category": "Collaboration & Productivity", "providesSoftware": true, "notes": ""}, {"name": "Slack", "industries": ["All"], "category": "Collaboration & Productivity", "providesSoftware": true, "notes": ""}, {"name": "Zoom", "industries": ["All"], "category": "Collaboration & Productivity", "providesSoftware": true, "notes": ""}, {"name": "Cisco Webex", "industries": ["All"], "category": "Collaboration & Productivity", "providesSoftware": true, "notes": ""}, {"name": "Atlassian", "industries": ["All"], "category": "Collaboration & Productivity", "providesSoftware": true, "notes": ""}, {"name": "Notion", "industries": ["All"], "category": "Collaboration & Productivity", "providesSoftware": true, "notes": ""}, {"name": "Box", "industries": ["All"], "category": "Collaboration & Productivity", "providesSoftware": true, "notes": ""}, {"name": "Dropbox", "industries": ["All"], "category": "Collaboration & Productivity", "providesSoftware": true, "notes": ""}, {"name": "SharePoint", "industries": ["All"], "category": "Collaboration & Productivity", "providesSoftware": true, "notes": ""}, {"name": "Confluence", "industries": ["All"], "category": "Collaboration & Productivity", "providesSoftware": true, "notes": ""}, {"name": "Jira", "industries": ["All"], "category": "Collaboration & Productivity", "providesSoftware": true, "notes": ""}, {"name": "CrowdStrike", "industries": ["All", "Financial Services", "Healthcare", "Technology"], "category": "Cybersecurity", "providesSoftware": true, "notes": ""}, {"name": "Palo Alto Networks", "industries": ["All", "Financial Services", "Healthcare", "Technology"], "category": "Cybersecurity", "providesSoftware": true, "notes": ""}, {"name": "Fortinet", "industries": ["All", "Financial Services", "Healthcare", "Technology"], "category": "Cybersecurity", "providesSoftware": true, "notes": ""}, {"name": "Check Point", "industries": ["All", "Financial Services", "Healthcare", "Technology"], "category": "Cybersecurity", "providesSoftware": true, "notes": ""}, {"name": "Zscaler", "industries": ["All", "Financial Services", "Healthcare", "Technology"], "category": "Cybersecurity", "providesSoftware": true, "notes": ""}, {"name": "Proofpoint", "industries": ["All", "Financial Services", "Healthcare", "Technology"], "category": "Cybersecurity", "providesSoftware": true, "notes": ""}, {"name": "Mimecast", "industries": ["All", "Financial Services", "Healthcare", "Technology"], "category": "Cybersecurity", "providesSoftware": true, "notes": ""}, {"name": "Splunk", "industries": ["All", "Financial Services", "Healthcare", "Technology"], "category": "Cybersecurity", "providesSoftware": true, "notes": ""}, {"name": "Snyk", "industries": ["All", "Financial Services", "Healthcare", "Technology"], "category": "Cybersecurity", "providesSoftware": true, "notes": ""}, {"name": "Tenable", "industries": ["All", "Financial Services", "Healthcare", "Technology"], "category": "Cybersecurity", "providesSoftware": true, "notes": ""}, {"name": "Qualys", "industries": ["All", "Financial Services", "Healthcare", "Technology"], "category": "Cybersecurity", "providesSoftware": true, "notes": ""}, {"name": "Rapid7", "industries": ["All", "Financial Services", "Healthcare", "Technology"], "category": "Cybersecurity", "providesSoftware": true, "notes": ""}, {"name": "SentinelOne", "industries": ["All", "Financial Services", "Healthcare", "Technology"], "category": "Cybersecurity", "providesSoftware": true, "notes": ""}, {"name": "Sophos", "industries": ["All", "Financial Services", "Healthcare", "Technology"], "category": "Cybersecurity", "providesSoftware": true, "notes": ""}, {"name": "Trend Micro", "industries": ["All", "Financial Services", "Healthcare", "Technology"], "category": "Cybersecurity", "providesSoftware": true, "notes": ""}, {"name": "Datadog Security", "industries": ["All", "Financial Services", "Healthcare", "Technology"], "category": "Cybersecurity", "providesSoftware": true, "notes": ""}, {"name": "Microsoft Defender", "industries": ["All", "Financial Services", "Healthcare", "Technology"], "category": "Cybersecurity", "providesSoftware": true, "notes": ""}, {"name": "AWS GuardDuty", "industries": ["All", "Financial Services", "Healthcare", "Technology"], "category": "Cybersecurity", "providesSoftware": true, "notes": ""}, {"name": "GitHub", "industries": ["Technology", "All"], "category": "DevOps & Engineering", "providesSoftware": true, "notes": ""}, {"name": "GitLab", "industries": ["Technology", "All"], "category": "DevOps & Engineering", "providesSoftware": true, "notes": ""}, {"name": "Bitbucket", "industries": ["Technology", "All"], "category": "DevOps & Engineering", "providesSoftware": true, "notes": ""}, {"name": "CircleCI", "industries": ["Technology", "All"], "category": "DevOps & Engineering", "providesSoftware": true, "notes": ""}, {"name": "Jenkins", "industries": ["Technology", "All"], "category": "DevOps & Engineering", "providesSoftware": true, "notes": ""}, {"name": "Docker", "industries": ["Technology", "All"], "category": "DevOps & Engineering", "providesSoftware": true, "notes": ""}, {"name": "Kubernetes", "industries": ["Technology", "All"], "category": "DevOps & Engineering", "providesSoftware": true, "notes": ""}, {"name": "HashiCorp", "industries": ["Technology", "All"], "category": "DevOps & Engineering", "providesSoftware": true, "notes": ""}, {"name": "Terraform Cloud", "industries": ["Technology", "All"], "category": "DevOps & Engineering", "providesSoftware": true, "notes": ""}, {"name": "Vercel", "industries": ["Technology", "All"], "category": "DevOps & Engineering", "providesSoftware": true, "notes": ""}, {"name": "Netlify", "industries": ["Technology", "All"], "category": "DevOps & Engineering", "providesSoftware": true, "notes": ""}, {"name": "Sentry", "industries": ["Technology", "All"], "category": "DevOps & Engineering", "providesSoftware": true, "notes": ""}, {"name": "Datadog", "industries": ["Technology", "All"], "category": "DevOps & Engineering", "providesSoftware": true, "notes": ""}, {"name": "New Relic", "industries": ["Technology", "All"], "category": "DevOps & Engineering", "providesSoftware": true, "notes": ""}, {"name": "PagerDuty", "industries": ["Technology", "All"], "category": "DevOps & Engineering", "providesSoftware": true, "notes": ""}, {"name": "ServiceNow", "industries": ["Technology", "All"], "category": "DevOps & Engineering", "providesSoftware": true, "notes": ""}, {"name": "Zendesk", "industries": ["Technology", "All"], "category": "DevOps & Engineering", "providesSoftware": true, "notes": ""}, {"name": "Stripe", "industries": ["Financial Services", "Retail", "All"], "category": "Payments/Financial", "providesSoftware": true, "notes": ""}, {"name": "PayPal", "industries": ["Financial Services", "Retail", "All"], "category": "Payments/Financial", "providesSoftware": true, "notes": ""}, {"name": "Square", "industries": ["Financial Services", "Retail", "All"], "category": "Payments/Financial", "providesSoftware": true, "notes": ""}, {"name": "Adyen", "industries": ["Financial Services", "Retail", "All"], "category": "Payments/Financial", "providesSoftware": true, "notes": ""}, {"name": "Fiserv", "industries": ["Financial Services", "Retail", "All"], "category": "Payments/Financial", "providesSoftware": true, "notes": ""}, {"name": "Worldpay", "industries": ["Financial Services", "Retail", "All"], "category": "Payments/Financial", "providesSoftware": true, "notes": ""}, {"name": "Visa", "industries": ["Financial Services", "Retail", "All"], "category": "Payments/Financial", "providesSoftware": true, "notes": ""}, {"name": "Mastercard", "industries": ["Financial Services", "Retail", "All"], "category": "Payments/Financial", "providesSoftware": true, "notes": ""}, {"name": "American Express", "industries": ["Financial Services", "Retail", "All"], "category": "Payments/Financial", "providesSoftware": true, "notes": ""}, {"name": "JPMorgan Chase", "industries": ["Financial Services", "Retail", "All"], "category": "Payments/Financial", "providesSoftware": true, "notes": ""}, {"name": "Bank of America", "industries": ["Financial Services", "Retail", "All"], "category": "Payments/Financial", "providesSoftware": true, "notes": ""}, {"name": "Wells Fargo", "industries": ["Financial Services", "Retail", "All"], "category": "Payments/Financial", "providesSoftware": true, "notes": ""}, {"name": "HSBC", "industries": ["Financial Services", "Retail", "All"], "category": "Payments/Financial", "providesSoftware": true, "notes": ""}, {"name": "Citibank", "industries": ["Financial Services", "Retail", "All"], "category": "Payments/Financial", "providesSoftware": true, "notes": ""}, {"name": "Wise", "industries": ["Financial Services", "Retail", "All"], "category": "Payments/Financial", "providesSoftware": true, "notes": ""}, {"name": "Payoneer", "industries": ["Financial Services", "Retail", "All"], "category": "Payments/Financial", "providesSoftware": true, "notes": ""}, {"name": "Workday", "industries": ["All", "Healthcare", "Financial Services"], "category": "HR & People Ops", "providesSoftware": true, "notes": ""}, {"name": "ADP", "industries": ["All", "Healthcare", "Financial Services"], "category": "HR & People Ops", "providesSoftware": true, "notes": ""}, {"name": "Paychex", "industries": ["All", "Healthcare", "Financial Services"], "category": "HR & People Ops", "providesSoftware": true, "notes": ""}, {"name": "BambooHR", "industries": ["All", "Healthcare", "Financial Services"], "category": "HR & People Ops", "providesSoftware": true, "notes": ""}, {"name": "Gusto", "industries": ["All", "Healthcare", "Financial Services"], "category": "HR & People Ops", "providesSoftware": true, "notes": ""}, {"name": "UKG", "industries": ["All", "Healthcare", "Financial Services"], "category": "HR & People Ops", "providesSoftware": true, "notes": ""}, {"name": "SAP SuccessFactors", "industries": ["All", "Healthcare", "Financial Services"], "category": "HR & People Ops", "providesSoftware": true, "notes": ""}, {"name": "Oracle HCM", "industries": ["All", "Healthcare", "Financial Services"], "category": "HR & People Ops", "providesSoftware": true, "notes": ""}, {"name": "Greenhouse", "industries": ["All", "Healthcare", "Financial Services"], "category": "HR & People Ops", "providesSoftware": true, "notes": ""}, {"name": "Lever", "industries": ["All", "Healthcare", "Financial Services"], "category": "HR & People Ops", "providesSoftware": true, "notes": ""}, {"name": "LinkedIn Talent Solutions", "industries": ["All", "Healthcare", "Financial Services"], "category": "HR & People Ops", "providesSoftware": true, "notes": ""}, {"name": "Salesforce", "industries": ["Retail", "All", "Technology"], "category": "CRM/Marketing", "providesSoftware": true, "notes": ""}, {"name": "HubSpot", "industries": ["Retail", "All", "Technology"], "category": "CRM/Marketing", "providesSoftware": true, "notes": ""}, {"name": "Marketo", "industries": ["Retail", "All", "Technology"], "category": "CRM/Marketing", "providesSoftware": true, "notes": ""}, {"name": "Mailchimp", "industries": ["Retail", "All", "Technology"], "category": "CRM/Marketing", "providesSoftware": true, "notes": ""}, {"name": "Klaviyo", "industries": ["Retail", "All", "Technology"], "category": "CRM/Marketing", "providesSoftware": true, "notes": ""}, {"name": "Zendesk", "industries": ["Retail", "All", "Technology"], "category": "CRM/Marketing", "providesSoftware": true, "notes": ""}, {"name": "Intercom", "industries": ["Retail", "All", "Technology"], "category": "CRM/Marketing", "providesSoftware": true, "notes": ""}, {"name": "Twilio", "industries": ["Retail", "All", "Technology"], "category": "CRM/Marketing", "providesSoftware": true, "notes": ""}, {"name": "SendGrid", "industries": ["Retail", "All", "Technology"], "category": "CRM/Marketing", "providesSoftware": true, "notes": ""}, {"name": "Postmark", "industries": ["Retail", "All", "Technology"], "category": "CRM/Marketing", "providesSoftware": true, "notes": ""}, {"name": "Braze", "industries": ["Retail", "All", "Technology"], "category": "CRM/Marketing", "providesSoftware": true, "notes": ""}, {"name": "Sprout Social", "industries": ["Retail", "All", "Technology"], "category": "CRM/Marketing", "providesSoftware": true, "notes": ""}, {"name": "Hootsuite", "industries": ["Retail", "All", "Technology"], "category": "CRM/Marketing", "providesSoftware": true, "notes": ""}, {"name": "Google Ads", "industries": ["Retail", "All", "Technology"], "category": "CRM/Marketing", "providesSoftware": true, "notes": ""}, {"name": "Meta Ads", "industries": ["Retail", "All", "Technology"], "category": "CRM/Marketing", "providesSoftware": true, "notes": ""}, {"name": "Snowflake", "industries": ["All", "Technology", "Retail", "Financial Services"], "category": "Data & Analytics", "providesSoftware": true, "notes": ""}, {"name": "Databricks", "industries": ["All", "Technology", "Retail", "Financial Services"], "category": "Data & Analytics", "providesSoftware": true, "notes": ""}, {"name": "Tableau", "industries": ["All", "Technology", "Retail", "Financial Services"], "category": "Data & Analytics", "providesSoftware": true, "notes": ""}, {"name": "Power BI", "industries": ["All", "Technology", "Retail", "Financial Services"], "category": "Data & Analytics", "providesSoftware": true, "notes": ""}, {"name": "Looker", "industries": ["All", "Technology", "Retail", "Financial Services"], "category": "Data & Analytics", "providesSoftware": true, "notes": ""}, {"name": "Segment", "industries": ["All", "Technology", "Retail", "Financial Services"], "category": "Data & Analytics", "providesSoftware": true, "notes": ""}, {"name": "Amplitude", "industries": ["All", "Technology", "Retail", "Financial Services"], "category": "Data & Analytics", "providesSoftware": true, "notes": ""}, {"name": "Mixpanel", "industries": ["All", "Technology", "Retail", "Financial Services"], "category": "Data & Analytics", "providesSoftware": true, "notes": ""}, {"name": "Google Analytics", "industries": ["All", "Technology", "Retail", "Financial Services"], "category": "Data & Analytics", "providesSoftware": true, "notes": ""}, {"name": "Plausible", "industries": ["All", "Technology", "Retail", "Financial Services"], "category": "Data & Analytics", "providesSoftware": true, "notes": ""}, {"name": "Umami", "industries": ["All", "Technology", "Retail", "Financial Services"], "category": "Data & Analytics", "providesSoftware": true, "notes": ""}, {"name": "Elastic", "industries": ["All", "Technology", "Retail", "Financial Services"], "category": "Data & Analytics", "providesSoftware": true, "notes": ""}, {"name": "MongoDB Atlas", "industries": ["All", "Technology", "Retail", "Financial Services"], "category": "Data & Analytics", "providesSoftware": true, "notes": ""}, {"name": "PostgreSQL (managed)", "industries": ["All", "Technology", "Retail", "Financial Services"], "category": "Data & Analytics", "providesSoftware": true, "notes": ""}, {"name": "BigQuery", "industries": ["All", "Technology", "Retail", "Financial Services"], "category": "Data & Analytics", "providesSoftware": true, "notes": ""}, {"name": "Redshift", "industries": ["All", "Technology", "Retail", "Financial Services"], "category": "Data & Analytics", "providesSoftware": true, "notes": ""}, {"name": "Backblaze", "industries": ["All"], "category": "Backup & Recovery", "providesSoftware": true, "notes": ""}, {"name": "Wasabi", "industries": ["All"], "category": "Backup & Recovery", "providesSoftware": true, "notes": ""}, {"name": "Veeam", "industries": ["All"], "category": "Backup & Recovery", "providesSoftware": true, "notes": ""}, {"name": "Rubrik", "industries": ["All"], "category": "Backup & Recovery", "providesSoftware": true, "notes": ""}, {"name": "Cohesity", "industries": ["All"], "category": "Backup & Recovery", "providesSoftware": true, "notes": ""}, {"name": "Commvault", "industries": ["All"], "category": "Backup & Recovery", "providesSoftware": true, "notes": ""}, {"name": "Carbonite", "industries": ["All"], "category": "Backup & Recovery", "providesSoftware": true, "notes": ""}, {"name": "Barracuda Backup", "industries": ["All"], "category": "Backup & Recovery", "providesSoftware": true, "notes": ""}, {"name": "Epic Systems", "industries": ["Healthcare"], "category": "Healthcare IT", "providesSoftware": true, "notes": ""}, {"name": "Cerner (Oracle Health)", "industries": ["Healthcare"], "category": "Healthcare IT", "providesSoftware": true, "notes": ""}, {"name": "athenahealth", "industries": ["Healthcare"], "category": "Healthcare IT", "providesSoftware": true, "notes": ""}, {"name": "Meditech", "industries": ["Healthcare"], "category": "Healthcare IT", "providesSoftware": true, "notes": ""}, {"name": "Teladoc Health", "industries": ["Healthcare"], "category": "Healthcare IT", "providesSoftware": true, "notes": ""}, {"name": "Change Healthcare", "industries": ["Healthcare"], "category": "Healthcare IT", "providesSoftware": true, "notes": ""}, {"name": "McKesson", "industries": ["Healthcare"], "category": "Healthcare IT", "providesSoftware": true, "notes": ""}, {"name": "Cardinal Health", "industries": ["Healthcare"], "category": "Healthcare IT", "providesSoftware": true, "notes": ""}, {"name": "Philips Healthcare IT", "industries": ["Healthcare"], "category": "Healthcare IT", "providesSoftware": true, "notes": ""}, {"name": "Bloomberg", "industries": ["Financial Services"], "category": "Financial Platforms", "providesSoftware": true, "notes": ""}, {"name": "Refinitiv (LSEG)", "industries": ["Financial Services"], "category": "Financial Platforms", "providesSoftware": true, "notes": ""}, {"name": "FIS", "industries": ["Financial Services"], "category": "Financial Platforms", "providesSoftware": true, "notes": ""}, {"name": "Finastra", "industries": ["Financial Services"], "category": "Financial Platforms", "providesSoftware": true, "notes": ""}, {"name": "Temenos", "industries": ["Financial Services"], "category": "Financial Platforms", "providesSoftware": true, "notes": ""}, {"name": "Jack Henry", "industries": ["Financial Services"], "category": "Financial Platforms", "providesSoftware": true, "notes": ""}, {"name": "SS&C Technologies", "industries": ["Financial Services"], "category": "Financial Platforms", "providesSoftware": true, "notes": ""}, {"name": "Broadridge", "industries": ["Financial Services"], "category": "Financial Platforms", "providesSoftware": true, "notes": ""}, {"name": "Moody's Analytics", "industries": ["Financial Services"], "category": "Financial Platforms", "providesSoftware": true, "notes": ""}, {"name": "S&P Global", "industries": ["Financial Services"], "category": "Financial Platforms", "providesSoftware": true, "notes": ""}, {"name": "Shopify", "industries": ["Retail"], "category": "Retail & eCommerce", "providesSoftware": true, "notes": ""}, {"name": "Magento (Adobe Commerce)", "industries": ["Retail"], "category": "Retail & eCommerce", "providesSoftware": true, "notes": ""}, {"name": "BigCommerce", "industries": ["Retail"], "category": "Retail & eCommerce", "providesSoftware": true, "notes": ""}, {"name": "Amazon Marketplace", "industries": ["Retail"], "category": "Retail & eCommerce", "providesSoftware": true, "notes": ""}, {"name": "Walmart Marketplace", "industries": ["Retail"], "category": "Retail & eCommerce", "providesSoftware": true, "notes": ""}, {"name": "Instacart", "industries": ["Retail"], "category": "Retail & eCommerce", "providesSoftware": true, "notes": ""}, {"name": "DoorDash", "industries": ["Retail"], "category": "Retail & eCommerce", "providesSoftware": true, "notes": ""}, {"name": "Uber Eats", "industries": ["Retail"], "category": "Retail & eCommerce", "providesSoftware": true, "notes": ""}, {"name": "Oracle Retail", "industries": ["Retail"], "category": "Retail & eCommerce", "providesSoftware": true, "notes": ""}, {"name": "NCR Voyix", "industries": ["Retail"], "category": "Retail & eCommerce", "providesSoftware": true, "notes": ""}, {"name": "SAP", "industries": ["Retail", "Manufacturing", "All"], "category": "Supply Chain & ERP", "providesSoftware": true, "notes": ""}, {"name": "Oracle", "industries": ["Retail", "Manufacturing", "All"], "category": "Supply Chain & ERP", "providesSoftware": true, "notes": ""}, {"name": "Microsoft Dynamics 365", "industries": ["Retail", "Manufacturing", "All"], "category": "Supply Chain & ERP", "providesSoftware": true, "notes": ""}, {"name": "Infor", "industries": ["Retail", "Manufacturing", "All"], "category": "Supply Chain & ERP", "providesSoftware": true, "notes": ""}, {"name": "Manhattan Associates", "industries": ["Retail", "Manufacturing", "All"], "category": "Supply Chain & ERP", "providesSoftware": true, "notes": ""}, {"name": "Blue Yonder", "industries": ["Retail", "Manufacturing", "All"], "category": "Supply Chain & ERP", "providesSoftware": true, "notes": ""}, {"name": "Coupa", "industries": ["Retail", "Manufacturing", "All"], "category": "Supply Chain & ERP", "providesSoftware": true, "notes": ""}, {"name": "Ariba (SAP)", "industries": ["Retail", "Manufacturing", "All"], "category": "Supply Chain & ERP", "providesSoftware": true, "notes": ""}, {"name": "DHL", "industries": ["Retail", "Manufacturing", "All"], "category": "Supply Chain & ERP", "providesSoftware": true, "notes": ""}, {"name": "FedEx", "industries": ["Retail", "Manufacturing", "All"], "category": "Supply Chain & ERP", "providesSoftware": true, "notes": ""}, {"name": "UPS", "industries": ["Retail", "Manufacturing", "All"], "category": "Supply Chain & ERP", "providesSoftware": true, "notes": ""}, {"name": "DocuSign", "industries": ["All", "Technology", "Financial Services"], "category": "GRC/Compliance", "providesSoftware": true, "notes": ""}, {"name": "Adobe Acrobat Sign", "industries": ["All", "Technology", "Financial Services"], "category": "GRC/Compliance", "providesSoftware": true, "notes": ""}, {"name": "Ironclad", "industries": ["All", "Technology", "Financial Services"], "category": "GRC/Compliance", "providesSoftware": true, "notes": ""}, {"name": "OneTrust", "industries": ["All", "Technology", "Financial Services"], "category": "GRC/Compliance", "providesSoftware": true, "notes": ""}, {"name": "TrustArc", "industries": ["All", "Technology", "Financial Services"], "category": "GRC/Compliance", "providesSoftware": true, "notes": ""}, {"name": "Vanta", "industries": ["All", "Technology", "Financial Services"], "category": "GRC/Compliance", "providesSoftware": true, "notes": ""}, {"name": "Drata", "industries": ["All", "Technology", "Financial Services"], "category": "GRC/Compliance", "providesSoftware": true, "notes": ""}, {"name": "Secureframe", "industries": ["All", "Technology", "Financial Services"], "category": "GRC/Compliance", "providesSoftware": true, "notes": ""}, {"name": "Tugboat Logic", "industries": ["All", "Technology", "Financial Services"], "category": "GRC/Compliance", "providesSoftware": true, "notes": ""}, {"name": "LogicGate", "industries": ["All", "Technology", "Financial Services"], "category": "GRC/Compliance", "providesSoftware": true, "notes": ""}, {"name": "Intune", "industries": ["All"], "category": "IT Management", "providesSoftware": true, "notes": ""}, {"name": "Jamf", "industries": ["All"], "category": "IT Management", "providesSoftware": true, "notes": ""}, {"name": "Kandji", "industries": ["All"], "category": "IT Management", "providesSoftware": true, "notes": ""}, {"name": "Ivanti", "industries": ["All"], "category": "IT Management", "providesSoftware": true, "notes": ""}, {"name": "ManageEngine", "industries": ["All"], "category": "IT Management", "providesSoftware": true, "notes": ""}, {"name": "Lansweeper", "industries": ["All"], "category": "IT Management", "providesSoftware": true, "notes": ""}, {"name": "SolarWinds", "industries": ["All"], "category": "IT Management", "providesSoftware": true, "notes": ""}, {"name": "CrowdStrike Falcon Complete", "industries": ["All"], "category": "IT Management", "providesSoftware": true, "notes": ""}, {"name": "Genesys", "industries": ["All", "Retail", "Financial Services"], "category": "Contact Center", "providesSoftware": true, "notes": ""}, {"name": "Five9", "industries": ["All", "Retail", "Financial Services"], "category": "Contact Center", "providesSoftware": true, "notes": ""}, {"name": "Nice CXone", "industries": ["All", "Retail", "Financial Services"], "category": "Contact Center", "providesSoftware": true, "notes": ""}];
  const VS_TEMPLATES = {"Healthcare": {"Identity & Access": ["Okta", "Microsoft Entra ID (Azure AD)", "Duo Security"], "Cloud/Infrastructure": ["Microsoft Azure", "Amazon Web Services (AWS)", "Google Cloud Platform (GCP)"], "Collaboration & Productivity": ["Microsoft 365", "Google Workspace", "Zoom"], "Healthcare IT": ["Epic Systems", "Cerner (Oracle Health)", "athenahealth"], "Cybersecurity": ["CrowdStrike", "Palo Alto Networks", "Proofpoint", "Tenable"], "GRC/Compliance": ["OneTrust", "Vanta", "Drata"]}, "Financial Services": {"Identity & Access": ["Okta", "Microsoft Entra ID (Azure AD)", "Ping Identity"], "Cloud/Infrastructure": ["Microsoft Azure", "Amazon Web Services (AWS)", "Google Cloud Platform (GCP)"], "Collaboration & Productivity": ["Microsoft 365", "Slack", "Zoom"], "Financial Platforms": ["Bloomberg", "FIS", "Finastra", "Moody's Analytics"], "Payments/Financial": ["Stripe", "Visa", "Mastercard"], "Cybersecurity": ["Palo Alto Networks", "CrowdStrike", "Zscaler", "Splunk", "Snyk"], "GRC/Compliance": ["OneTrust", "LogicGate", "Vanta"]}, "Retail": {"Identity & Access": ["Okta", "Google Workspace", "Duo Security"], "Cloud/Infrastructure": ["Amazon Web Services (AWS)", "Google Cloud Platform (GCP)", "Cloudflare"], "Retail & eCommerce": ["Shopify", "BigCommerce", "Magento (Adobe Commerce)", "NCR Voyix"], "Payments/Financial": ["Stripe", "PayPal", "Square", "Adyen"], "CRM/Marketing": ["Salesforce", "HubSpot", "Klaviyo", "Mailchimp"], "Cybersecurity": ["CrowdStrike", "Proofpoint", "Zscaler"], "Supply Chain & ERP": ["SAP", "Oracle", "Coupa", "DHL"]}, "Technology": {"Identity & Access": ["Okta", "Auth0", "Microsoft Entra ID (Azure AD)"], "Cloud/Infrastructure": ["Amazon Web Services (AWS)", "Google Cloud Platform (GCP)", "Microsoft Azure", "Cloudflare"], "DevOps & Engineering": ["GitHub", "GitLab", "Docker", "Kubernetes", "Terraform Cloud", "Vercel", "Netlify"], "Data & Analytics": ["Snowflake", "Databricks", "Looker", "Segment"], "Cybersecurity": ["Snyk", "CrowdStrike", "Tenable", "Rapid7"], "Collaboration & Productivity": ["Slack", "Atlassian", "Notion"]}};
  const DEMO_LIMIT = 8;
  const REQUIRED_COLS = ['name','category','dataTypes','sector','location','contact','notes','sbomAvailable','sbomFormat','providesSoftware'];

  function normalize(s){ return String(s||'').trim(); }
  function slug(s){ return normalize(s).toLowerCase(); }
  function escapeHtml(str){ return String(str).replace(/[&<>"']/g, (m)=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }

  function ensureToolbarButtons(){
    const toolbar = document.querySelector('.toolbar');
    if(!toolbar) return;
    if(document.getElementById('vsBtnCatalog')) return;

    const group = document.createElement('div');
    group.className = 'toolbar-group';
    group.style.gap = '10px';
    group.innerHTML = `
      <button id="vsBtnTemplate" onclick="VSUI.downloadTemplate()">CSV Template</button>
      <button id="vsBtnCatalog" onclick="VSUI.open('vsCatalogBackdrop')">Catalog</button>
      <button id="vsBtnWizard" onclick="VSUI.open('vsWizardBackdrop')">Onboarding Wizard</button>
      <button id="vsBtnApi" onclick="VSUI.open('vsApiBackdrop')">API Mockups</button>
    `;
    toolbar.prepend(group);
  }

  function buildCategoryOptions(){
    const sel = document.getElementById('vsCatalogCategory');
    if(!sel) return;
    const cats = Array.from(new Set(VS_CATALOG.map(v=>v.category))).sort();
    sel.innerHTML = '<option value="All">All</option>' + cats.map(c=>`<option value="${escapeHtml(c)}">${escapeHtml(c)}</option>`).join('');
  }

  const selection = new Set();

  function renderCatalog(){
    const q = slug(document.getElementById('vsCatalogSearch')?.value);
    const ind = document.getElementById('vsCatalogIndustry')?.value || 'All';
    const cat = document.getElementById('vsCatalogCategory')?.value || 'All';

    const rows = VS_CATALOG.filter(v=>{
      const hit = !q || slug(v.name).includes(q) || slug(v.category).includes(q) || (v.industries||[]).some(x=>slug(x).includes(q));
      const indHit = ind==='All' || (v.industries||[]).includes('All') || (v.industries||[]).includes(ind);
      const catHit = cat==='All' || v.category===cat;
      return hit && indHit && catHit;
    });

    const tbody = document.getElementById('vsCatalogTbody');
    if(!tbody) return;
    tbody.innerHTML = rows.map(v=>{
      const key = v.name;
      const checked = selection.has(key) ? 'checked' : '';
      const industries = (v.industries||[]).slice(0,4).join(', ') + ((v.industries||[]).length>4 ? 'â€¦' : '');
      return `
        <tr>
          <td><input type="checkbox" data-vs-name="${escapeHtml(key)}" ${checked} onchange="VSUI.toggleCatalogSelection(this)" /></td>
          <td><b>${escapeHtml(v.name)}</b><div class="vs-muted">${escapeHtml(v.notes||'')}</div></td>
          <td>${escapeHtml(v.category)}</td>
          <td class="vs-muted">${escapeHtml(industries)}</td>
          <td><button class="vs-btn primary" onclick="VSUI.addVendorFromCatalog('${escapeHtml(key)}')">Add</button></td>
        </tr>
      `;
    }).join('');

    const countEl = document.getElementById('vsCatalogCount');
    if(countEl) countEl.textContent = String(rows.length);
    const selEl = document.getElementById('vsCatalogSelectedCount');
    if(selEl) selEl.textContent = String(selection.size);
  }

  function mapCatalogVendorToRecord(v, overrides={}){
    return {
      id: (typeof generateId === 'function') ? generateId() : Math.random().toString(36).slice(2),
      name: v.name,
      category: overrides.category || 'tactical',
      dataTypes: overrides.dataTypes || ['Confidential'],
      sector: overrides.sector || v.category,
      location: overrides.location || 'Unknown',
      contact: overrides.contact || '',
      notes: overrides.notes || (v.notes || ''),
      providesSoftware: (typeof overrides.providesSoftware === 'boolean') ? overrides.providesSoftware : !!v.providesSoftware,
      sbomAvailable: (typeof overrides.sbomAvailable === 'boolean') ? overrides.sbomAvailable : false,
      sbomFormat: overrides.sbomFormat || 'none'
    };
  }

  function addVendorsToWorkingList(records) {
    if(!Array.isArray(records) || records.length===0) return;
    const current = (Array.isArray(window.vendorData) ? window.vendorData : []);
    const room = DEMO_LIMIT - current.length;
    if(room <= 0) {
      if(typeof showUpgradeModal === 'function') showUpgradeModal('Vendor limit reached in demo mode.');
      else alert('Vendor limit reached in demo mode.');
      return;
    }
    const trimmed = records.slice(0, room);
    window.vendorData = current.concat(trimmed);
    if(typeof updateRadar === 'function') updateRadar();
    if(typeof updateKPIs === 'function') updateKPIs();
    if(typeof updateVendorList === 'function') updateVendorList();
  }

  function downloadCsv(filename, csvText){
    const blob = new Blob([csvText], {type:'text/csv;charset=utf-8;'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    a.remove();
    setTimeout(()=>URL.revokeObjectURL(url), 2000);
  }

  function templateCsv() {
    const header = REQUIRED_COLS.join(',');
    const rows = [
      ['AWS','critical','PII;Financial;Confidential','Cloud Services','United States','security@aws.amazon.com','Primary cloud infrastructure provider','false','none','true'],
      ['Okta','strategic','PII;Confidential','Identity & Access','United States','security@okta.com','SSO/IdP','true','SPDX','true'],
      ['Salesforce','strategic','PII;Confidential','CRM/Marketing','United States','security@salesforce.com','Customer relationship management','false','none','true']
    ];
    const csv = [header].concat(rows.map(r=>r.map(x=>String(x).replaceAll('"','""')).map(x=>`"${x}"`).join(','))).join('\n');
    return csv;
  }

  function validateRecord(obj){
    const errors = [];
    if(!normalize(obj.name)) errors.push('name is required');
    const cat = slug(obj.category);
    if(!['critical','strategic','tactical','commodity'].includes(cat)) errors.push('category must be one of: critical, strategic, tactical, commodity');
    if(obj.sbomAvailable && !['spdx','cyclonedx','none'].includes(slug(obj.sbomFormat))) errors.push('sbomFormat must be SPDX, CycloneDX, or none');
    return errors;
  }

  // Wizard state
  const wizard = {
    step: 0,
    industry: Object.keys(VS_TEMPLATES)[0] || 'Technology',
    sso: 'Okta',
    include: new Set(),
    dataTypes: new Set(['Confidential']),
    criticality: 'strategic'
  };
  const steps = ['Industry', 'SSO/Identity', 'Stack Template', 'Data Exposure', 'Review'];

  function renderStepper(){
    const el = document.getElementById('vsWizardStepper');
    if(!el) return;
    el.innerHTML = steps.map((s,i)=>`<span class="vs-step ${i===wizard.step?'active':''}">${i+1}. ${s}</span>`).join('');
  }

  function renderWizard(){
    renderStepper();
    const c = document.getElementById('vsWizardContent');
    if(!c) return;

    if(wizard.step===0){
      c.innerHTML = `
        <div class="vs-card">
          <div class="vs-field">
            <label>Select your industry</label>
            <select class="vs-select" id="vsWIndustry">
              ${Object.keys(VS_TEMPLATES).map(k=>`<option value="${escapeHtml(k)}" ${k===wizard.industry?'selected':''}>${escapeHtml(k)}</option>`).join('')}
            </select>
          </div>
          <div class="vs-muted">This will preload a realistic baseline vendor stack for your sector.</div>
        </div>
      `;
      document.getElementById('vsWIndustry').onchange = (e)=>wizard.industry = e.target.value;
      return;
    }

    if(wizard.step===1){
      c.innerHTML = `
        <div class="vs-card">
          <div class="vs-field">
            <label>Primary identity provider (SSO)</label>
            <select class="vs-select" id="vsWSSO">
              ${['Okta','Microsoft Entra ID (Azure AD)','Google Workspace','Ping Identity','OneLogin'].map(x=>`<option value="${escapeHtml(x)}" ${x===wizard.sso?'selected':''}>${escapeHtml(x)}</option>`).join('')}
            </select>
          </div>
          <div class="vs-alert">In production, VendorSoluce can pull assigned apps via SCIM/OAuth. Here we only preview what it would look like.</div>
        </div>
      `;
      document.getElementById('vsWSSO').onchange = (e)=>wizard.sso = e.target.value;
      return;
    }

    if(wizard.step===2){
      const tpl = VS_TEMPLATES[wizard.industry] || {};
      const blocks = Object.entries(tpl).map(([cat,list])=>{
        const pills = list.map(v=>`<span class="vs-pill"><input type="checkbox" style="margin:0" data-v="${escapeHtml(v)}" onchange="VSUI.wizardToggleVendor(this)" ${wizard.include.has(v)?'checked':''} /> ${escapeHtml(v)}</span>`).join('');
        return `
          <div class="vs-card" style="margin-bottom:12px">
            <div class="vs-row" style="justify-content:space-between;align-items:center">
              <div><b>${escapeHtml(cat)}</b><div class="vs-muted">${list.length} common vendors</div></div>
              <button class="vs-btn primary" onclick="VSUI.wizardAddCategory('${escapeHtml(cat)}')">Add all</button>
            </div>
            <div class="vs-row" style="margin-top:10px">${pills}</div>
          </div>
        `;
      }).join('');
      c.innerHTML = `
        <div class="vs-alert">Choose vendors that match your stack. You can also use the Catalog for more vendors.</div>
        ${blocks}
      `;
      return;
    }

    if(wizard.step===3){
      const opts = ['PII','PHI','Financial','IP','Confidential'];
      c.innerHTML = `
        <div class="vs-card">
          <div class="vs-field">
            <label>Data types shared with vendors</label>
            <div class="vs-row">
              ${opts.map(o=>`<span class="vs-pill"><input type="checkbox" style="margin:0" onchange="VSUI.wizardToggleDataType('${o}', this.checked)" ${wizard.dataTypes.has(o)?'checked':''} /> ${o}</span>`).join('')}
            </div>
          </div>
          <div class="vs-field">
            <label>Default criticality for imported stack</label>
            <select class="vs-select" id="vsWCrit">
              ${['critical','strategic','tactical','commodity'].map(x=>`<option value="${x}" ${x===wizard.criticality?'selected':''}>${x}</option>`).join('')}
            </select>
          </div>
          <div class="vs-muted">You can adjust individual vendors later in the vendor drawer.</div>
        </div>
      `;
      document.getElementById('vsWCrit').onchange = (e)=>wizard.criticality = e.target.value;
      return;
    }

    if(wizard.step===4){
      const list = Array.from(wizard.include);
      c.innerHTML = `
        <div class="vs-card">
          <div class="vs-row" style="justify-content:space-between;align-items:center">
            <div>
              <b>Ready to generate your vendor list</b>
              <div class="vs-muted">Industry: ${escapeHtml(wizard.industry)} â€¢ SSO: ${escapeHtml(wizard.sso)} â€¢ Vendors selected: ${list.length}</div>
            </div>
            <button class="vs-btn primary" onclick="VSUI.wizardApply()">Generate list</button>
          </div>
          <div class="vs-row" style="margin-top:12px">
            ${list.slice(0,24).map(v=>`<span class="vs-pill">${escapeHtml(v)}</span>`).join('')}
            ${list.length>24 ? `<span class="vs-muted">+${list.length-24} moreâ€¦</span>` : ''}
          </div>
        </div>
      `;
      return;
    }
  }

  function open(id){
    document.getElementById(id).style.display='flex';
    if(id==='vsCatalogBackdrop'){ buildCategoryOptions(); renderCatalog(); }
    if(id==='vsWizardBackdrop'){
      wizard.step=0;
      wizard.include.clear();
      const tpl = VS_TEMPLATES[wizard.industry]||{};
      Object.values(tpl).flat().slice(0,12).forEach(v=>wizard.include.add(v));
      renderWizard();
    }
    if(id==='vsApiBackdrop'){ VSUI.previewApiMock(); }
  }
  function close(id){ document.getElementById(id).style.display='none'; }

  function toggleCatalogSelection(cb){
    const n = cb.getAttribute('data-vs-name');
    if(cb.checked) selection.add(n); else selection.delete(n);
    renderCatalog();
  }
  function clearCatalogSelection(){ selection.clear(); renderCatalog(); }
  function selectTopVisible(n){
    const boxes = Array.from(document.querySelectorAll('#vsCatalogTbody input[type="checkbox"]'));
    boxes.slice(0,n).forEach(b=>{ b.checked=true; selection.add(b.getAttribute('data-vs-name')); });
    renderCatalog();
  }
  function addVendorFromCatalog(name){
    const v = VS_CATALOG.find(x=>x.name===name);
    if(!v) return;
    addVendorsToWorkingList([mapCatalogVendorToRecord(v)]);
  }
  function addSelectedFromCatalog(){
    const chosen = Array.from(selection).map(name=>VS_CATALOG.find(x=>x.name===name)).filter(Boolean).map(v=>mapCatalogVendorToRecord(v));
    addVendorsToWorkingList(chosen);
    selection.clear();
    renderCatalog();
  }

  function downloadTemplate(){
    const csv = templateCsv();
    downloadCsv('vendorsoluce_vendor_import_template.csv', csv);
    const msg = [
      'Template downloaded.',
      'Validation rules:',
      '- name required',
      '- category: critical|strategic|tactical|commodity',
      '- dataTypes: separate with semicolons (PII;PHI;Financial;IP;Confidential)',
      '- sbomAvailable: true|false',
      '- sbomFormat: SPDX|CycloneDX|none'
    ].join('\n');
    if(typeof showToast==='function') showToast(msg);
    else console.log(msg);
  }

  function wizardPrev(){ wizard.step = Math.max(0, wizard.step-1); renderWizard(); }
  function wizardNext(){ wizard.step = Math.min(steps.length-1, wizard.step+1); renderWizard(); }
  function wizardSkip(){ wizard.step = Math.min(steps.length-1, wizard.step+1); renderWizard(); }
  function wizardToggleVendor(cb){
    const v = cb.getAttribute('data-v');
    if(cb.checked) wizard.include.add(v); else wizard.include.delete(v);
  }
  function wizardAddCategory(cat){
    const tpl = VS_TEMPLATES[wizard.industry]||{};
    (tpl[cat]||[]).forEach(v=>wizard.include.add(v));
    renderWizard();
  }
  function wizardToggleDataType(dt, on){ if(on) wizard.dataTypes.add(dt); else wizard.dataTypes.delete(dt); }
  function wizardApply(){
    const records = Array.from(wizard.include).map(name=>VS_CATALOG.find(v=>v.name===name) || {name, category:'', industries:[wizard.industry], providesSoftware:true, notes:''});
    const mapped = records.map(v=>mapCatalogVendorToRecord(v, {
      category: wizard.criticality,
      dataTypes: Array.from(wizard.dataTypes),
      location: 'Unknown',
      notes: (v.notes||'') + (v.providesSoftware ? ' â€¢ Software vendor' : '')
    }));
    const ssoName = wizard.sso;
    if(!Array.from(wizard.include).includes(ssoName)) {
      const v = VS_CATALOG.find(x=>x.name===ssoName) || {name:ssoName, category:'Identity & Access', industries:['All'], providesSoftware:true, notes:'Identity provider'};
      mapped.unshift(mapCatalogVendorToRecord(v, {category:'critical', dataTypes:['PII','Confidential'], sector:'Identity & Access'}));
    }
    addVendorsToWorkingList(mapped);
    close('vsWizardBackdrop');
  }

  function apiMock(provider){
    const base = {
      okta: { endpoints: ['GET /api/v1/apps', 'GET /api/v1/groups', 'GET /api/v1/users'], sample: [
        {app:'Salesforce', owner:'IT', sso:'SAML', groups:['Sales','RevOps']},
        {app:'Workday', owner:'HR', sso:'OIDC', groups:['HR']},
        {app:'AWS', owner:'Security', sso:'SAML', groups:['Engineering','Infra']}
      ]},
      entra: { endpoints: ['GET /v1.0/applications', 'GET /v1.0/servicePrincipals', 'GET /v1.0/groups'], sample: [
        {app:'Microsoft 365', owner:'IT', sso:'OIDC', groups:['All Employees']},
        {app:'ServiceNow', owner:'IT', sso:'SAML', groups:['ITSM']},
        {app:'GitHub', owner:'Engineering', sso:'SAML', groups:['Developers']}
      ]},
      google: { endpoints: ['GET /admin/directory/v1/apps', 'GET /admin/directory/v1/groups', 'GET /admin/directory/v1/users'], sample: [
        {app:'Google Workspace', owner:'IT', sso:'OIDC', groups:['All']},
        {app:'Zoom', owner:'IT', sso:'SAML', groups:['All']},
        {app:'Slack', owner:'IT', sso:'SAML', groups:['All']}
      ]},
      ping: { endpoints: ['GET /v1/applications', 'GET /v1/groups', 'GET /v1/users'], sample: [
        {app:'Salesforce', owner:'IT', sso:'SAML', groups:['Sales']},
        {app:'Workday', owner:'HR', sso:'SAML', groups:['HR']}
      ]},
      onelogin: { endpoints: ['GET /api/2/apps', 'GET /api/2/groups', 'GET /api/2/users'], sample: [
        {app:'Zendesk', owner:'CX', sso:'SAML', groups:['Support']},
        {app:'HubSpot', owner:'Marketing', sso:'SAML', groups:['Marketing']}
      ]}
    };
    return base[provider] || base.okta;
  }

  function previewApiMock(){
    const prov = document.getElementById('vsApiProvider')?.value || 'okta';
    const mock = apiMock(prov);
    const preview = {
      provider: prov,
      endpoints: mock.endpoints,
      response: mock.sample,
      mapping: { vendorName: 'app', sector: 'Derived from app category', owner: 'owner', ssoMethod: 'sso', groups: 'groups[]' }
    };
    const el = document.getElementById('vsApiPreview');
    if(el) el.textContent = JSON.stringify(preview, null, 2);
  }

  function applyApiMock(){
    const prov = document.getElementById('vsApiProvider')?.value || 'okta';
    const mock = apiMock(prov);
    const records = mock.sample.map(s=>{
      const v = VS_CATALOG.find(x=>x.name===s.app) || {name:s.app, category:'', industries:['All'], providesSoftware:true, notes:''};
      return mapCatalogVendorToRecord(v, {
        category: 'strategic',
        dataTypes: ['Confidential'],
        sector: v.category || 'SaaS',
        notes: (v.notes||'') + ` â€¢ Detected via IdP (${prov}) â€¢ Owner: ${s.owner} â€¢ SSO: ${s.sso}`
      });
    });
    addVendorsToWorkingList(records);
    close('vsApiBackdrop');
  }

  window.VSUI = {
    open, close,
    toggleCatalogSelection, clearCatalogSelection, selectTopVisible,
    addVendorFromCatalog, addSelectedFromCatalog,
    downloadTemplate,
    wizardPrev, wizardNext, wizardSkip,
    wizardToggleVendor, wizardAddCategory, wizardToggleDataType, wizardApply,
    previewApiMock, applyApiMock
  };

  document.addEventListener('DOMContentLoaded', ()=>{
    ensureToolbarButtons();
    buildCategoryOptions();
    const search = document.getElementById('vsCatalogSearch');
    const ind = document.getElementById('vsCatalogIndustry');
    const cat = document.getElementById('vsCatalogCategory');
    if(search) search.addEventListener('input', renderCatalog);
    if(ind) ind.addEventListener('change', renderCatalog);
    if(cat) cat.addEventListener('change', renderCatalog);
  });
})();
</script>
</body>
</html>
